'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.THIS = undefined;

var _templateVisitor = require('./template-visitor');

var _templateVisitor2 = _interopRequireDefault(_templateVisitor);

var _javascriptCompiler = require('./javascript-compiler');

var _javascriptCompiler2 = _interopRequireDefault(_javascriptCompiler);

var _util = require('@glimmer/util');

var _syntax = require('@glimmer/syntax');

var _utils = require('./utils');

var _allocateSymbols = require('./allocate-symbols');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function isTrustedValue(value) {
    return value.escaped !== undefined && !value.escaped;
}
const THIS = exports.THIS = 0;
class TemplateCompiler {
    constructor() {
        this.templateId = 0;
        this.templateIds = [];
        this.opcodes = [];
        this.includeMeta = false;
    }
    static compile(ast, options) {
        let templateVisitor = new _templateVisitor2.default();
        templateVisitor.visit(ast);
        let compiler = new TemplateCompiler();
        let opcodes = compiler.process(templateVisitor.actions);
        let symbols = new _allocateSymbols.SymbolAllocator(opcodes).process();
        return _javascriptCompiler2.default.process(symbols, ast['symbols'], options);
    }
    process(actions) {
        actions.forEach(([name, ...args]) => {
            if (!this[name]) {
                throw new Error(`Unimplemented ${name} on TemplateCompiler`);
            }
            this[name](...args);
        });
        return this.opcodes;
    }
    startProgram([program]) {
        this.opcode(['startProgram', program], program);
    }
    endProgram() {
        this.opcode(['endProgram', null], null);
    }
    startBlock([program]) {
        this.templateId++;
        this.opcode(['startBlock', program], program);
    }
    endBlock() {
        this.templateIds.push(this.templateId - 1);
        this.opcode(['endBlock', null], null);
    }
    text([action]) {
        this.opcode(['text', action.chars], action);
    }
    comment([action]) {
        this.opcode(['comment', action.value], action);
    }
    openElement([action]) {
        let attributes = action.attributes;
        let hasSplat = false;
        for (let i = 0; i < attributes.length; i++) {
            let attr = attributes[i];
            if (attr.name === '...attributes') {
                hasSplat = true;
                break;
            }
        }
        let actionIsComponent = false;
        if (isDynamicComponent(action)) {
            let head, rest;
            [head, ...rest] = action.tag.split('.');
            if (head === 'this') {
                head = 0;
            }
            this.opcode(['get', [head, rest]]);
            this.opcode(['openComponent', action], action);
            actionIsComponent = true;
        } else if (isComponent(action)) {
            this.opcode(['openComponent', action], action);
            actionIsComponent = true;
        } else if (hasSplat) {
            this.opcode(['openSplattedElement', action], action);
        } else {
            this.opcode(['openElement', action], action);
        }
        let typeAttr = null;
        let attrs = action.attributes;
        for (let i = 0; i < attrs.length; i++) {
            if (attrs[i].name === 'type') {
                typeAttr = attrs[i];
                continue;
            }
            this.attribute([attrs[i]], hasSplat || actionIsComponent);
        }
        if (typeAttr) {
            this.attribute([typeAttr], hasSplat || actionIsComponent);
        }
        this.opcode(['flushElement', action], null);
    }
    closeElement([action]) {
        if (isDynamicComponent(action)) {
            this.opcode(['closeDynamicComponent', action], action);
        } else if (isComponent(action)) {
            this.opcode(['closeComponent', action], action);
        } else if (action.modifiers.length > 0) {
            for (let i = 0; i < action.modifiers.length; i++) {
                this.modifier([action.modifiers[i]]);
            }
            this.opcode(['closeElement', action], action);
        } else {
            this.opcode(['closeElement', action], action);
        }
    }
    attribute([action], isComponent) {
        let { name, value } = action;
        let namespace = (0, _utils.getAttrNamespace)(name);
        let isStatic = this.prepareAttributeValue(value);
        if (name.charAt(0) === '@') {
            // Arguments
            if (isStatic) {
                this.opcode(['staticArg', name], action);
            } else if (action.value.type === 'MustacheStatement') {
                this.opcode(['dynamicArg', name], action);
            } else {
                this.opcode(['dynamicArg', name], action);
            }
        } else {
            let isTrusting = isTrustedValue(value);
            if (isStatic && name === '...attributes') {
                this.opcode(['attrSplat', null], action);
            } else if (isStatic && !isComponent) {
                this.opcode(['staticAttr', [name, namespace]], action);
            } else if (isTrusting) {
                this.opcode([isComponent ? 'trustingComponentAttr' : 'trustingAttr', [name, namespace]], action);
            } else if (action.value.type === 'MustacheStatement') {
                this.opcode([isComponent ? 'componentAttr' : 'dynamicAttr', [name, null]], action);
            } else {
                this.opcode([isComponent ? 'componentAttr' : 'dynamicAttr', [name, namespace]], action);
            }
        }
    }
    modifier([action]) {
        assertIsSimplePath(action.path, action.loc, 'modifier');
        let { path: { parts } } = action;
        this.prepareHelper(action);
        this.opcode(['modifier', parts[0]], action);
    }
    mustache([action]) {
        let { path } = action;
        if ((0, _syntax.isLiteral)(path)) {
            this.mustacheExpression(action);
            this.opcode(['append', !action.escaped], action);
        } else if (isYield(path)) {
            let to = assertValidYield(action);
            this.yield(to, action);
        } else if (isPartial(path)) {
            let params = assertValidPartial(action);
            this.partial(params, action);
        } else if (isDebugger(path)) {
            assertValidDebuggerUsage(action);
            this.debugger('debugger', action);
        } else {
            this.mustacheExpression(action);
            this.opcode(['append', !action.escaped], action);
        }
    }
    block([action /*, index, count*/]) {
        this.prepareHelper(action);
        let templateId = this.templateIds.pop();
        let inverseId = action.inverse === null ? null : this.templateIds.pop();
        this.opcode(['block', [action.path.parts[0], templateId, inverseId]], action);
    }
    /// Internal actions, not found in the original processed actions
    arg([path]) {
        let { parts: [head, ...rest] } = path;
        this.opcode(['get', [`@${head}`, rest]], path);
    }
    mustacheExpression(expr) {
        let { path } = expr;
        if ((0, _syntax.isLiteral)(path)) {
            this.opcode(['literal', path.value], expr);
        } else if (isBuiltInHelper(path)) {
            this.builtInHelper(expr);
        } else if (isArg(path)) {
            this.arg([path]);
        } else if (isHelperInvocation(expr)) {
            this.prepareHelper(expr);
            this.opcode(['helper', path.parts[0]], expr);
        } else if (path.this) {
            this.opcode(['get', [0, path.parts]], expr);
        } else {
            let [head, ...parts] = path.parts;
            this.opcode(['maybeGet', [head, parts]], expr);
        }
        // } else if (isLocal(path, this.symbols)) {
        //   let [head, ...parts] = path.parts;
        //   this.opcode(['get', [head, parts]], expr);
        // } else if (isSimplePath(path)) {
        //   this.opcode(['unknown', path.parts[0]], expr);
        // } else {
        //   this.opcode(['maybeLocal', path.parts], expr);
        // }
    }
    /// Internal Syntax
    yield(to, action) {
        this.prepareParams(action.params);
        this.opcode(['yield', to], action);
    }
    debugger(_name, action) {
        this.opcode(['debugger', null], action);
    }
    hasBlock(name, action) {
        this.opcode(['hasBlock', name], action);
    }
    hasBlockParams(name, action) {
        this.opcode(['hasBlockParams', name], action);
    }
    partial(_params, action) {
        this.prepareParams(action.params);
        this.opcode(['partial', null], action);
    }
    builtInHelper(expr) {
        let { path } = expr;
        if (isHasBlock(path)) {
            let name = assertValidHasBlockUsage(expr.path.original, expr);
            this.hasBlock(name, expr);
        } else if (isHasBlockParams(path)) {
            let name = assertValidHasBlockUsage(expr.path.original, expr);
            this.hasBlockParams(name, expr);
        }
    }
    /// Expressions, invoked recursively from prepareParams and prepareHash
    SubExpression(expr) {
        if (isBuiltInHelper(expr.path)) {
            this.builtInHelper(expr);
        } else {
            this.prepareHelper(expr);
            this.opcode(['helper', expr.path.parts[0]], expr);
        }
    }
    PathExpression(expr) {
        if (expr.data) {
            this.arg([expr]);
        } else {
            let [head, ...rest] = expr.parts;
            if (expr.this) {
                this.opcode(['get', [0, expr.parts]], expr);
            } else {
                this.opcode(['get', [head, rest]], expr);
            }
        }
    }
    StringLiteral(action) {
        this.opcode(['literal', action.value], action);
    }
    BooleanLiteral(action) {
        this.opcode(['literal', action.value], action);
    }
    NumberLiteral(action) {
        this.opcode(['literal', action.value], action);
    }
    NullLiteral(action) {
        this.opcode(['literal', action.value], action);
    }
    UndefinedLiteral(action) {
        this.opcode(['literal', action.value], action);
    }
    /// Utilities
    opcode(opcode, action = null) {
        // TODO: This doesn't really work
        if (this.includeMeta && action) {
            opcode.push(this.meta(action));
        }
        this.opcodes.push(opcode);
    }
    prepareHelper(expr) {
        assertIsSimplePath(expr.path, expr.loc, 'helper');
        let { params, hash } = expr;
        this.prepareHash(hash);
        this.prepareParams(params);
    }
    prepareParams(params) {
        if (!params.length) {
            this.opcode(['literal', null], null);
            return;
        }
        for (let i = params.length - 1; i >= 0; i--) {
            let param = params[i];
            false && (0, _util.assert)(this[param.type], `Unimplemented ${param.type} on TemplateCompiler`);

            this[param.type](param);
        }
        this.opcode(['prepareArray', params.length], null);
    }
    prepareHash(hash) {
        let pairs = hash.pairs;
        if (!pairs.length) {
            this.opcode(['literal', null], null);
            return;
        }
        for (let i = pairs.length - 1; i >= 0; i--) {
            let { key, value } = pairs[i];
            false && (0, _util.assert)(this[value.type], `Unimplemented ${value.type} on TemplateCompiler`);

            this[value.type](value);
            this.opcode(['literal', key], null);
        }
        this.opcode(['prepareObject', pairs.length], null);
    }
    prepareAttributeValue(value) {
        // returns the static value if the value is static
        switch (value.type) {
            case 'TextNode':
                this.opcode(['literal', value.chars], value);
                return true;
            case 'MustacheStatement':
                this.attributeMustache([value]);
                return false;
            case 'ConcatStatement':
                this.prepareConcatParts(value.parts);
                this.opcode(['concat', null], value);
                return false;
        }
    }
    prepareConcatParts(parts) {
        for (let i = parts.length - 1; i >= 0; i--) {
            let part = parts[i];
            if (part.type === 'MustacheStatement') {
                this.attributeMustache([part]);
            } else if (part.type === 'TextNode') {
                this.opcode(['literal', part.chars], null);
            }
        }
        this.opcode(['prepareArray', parts.length], null);
    }
    attributeMustache([action]) {
        this.mustacheExpression(action);
    }
    meta(node) {
        let loc = node.loc;
        if (!loc) {
            return [];
        }
        let { source, start, end } = loc;
        return ['loc', [source || null, [start.line, start.column], [end.line, end.column]]];
    }
}
exports.default = TemplateCompiler;
function isHelperInvocation(mustache) {
    return mustache.params && mustache.params.length > 0 || mustache.hash && mustache.hash.pairs.length > 0;
}
function isSimplePath({ parts }) {
    return parts.length === 1;
}
function isYield(path) {
    return path.original === 'yield';
}
function isPartial(path) {
    return path.original === 'partial';
}
function isDebugger(path) {
    return path.original === 'debugger';
}
function isHasBlock(path) {
    return path.original === 'has-block';
}
function isHasBlockParams(path) {
    return path.original === 'has-block-params';
}
function isBuiltInHelper(path) {
    return isHasBlock(path) || isHasBlockParams(path);
}
function isArg(path) {
    return !!path['data'];
}
function isDynamicComponent(element) {
    let open = element.tag.charAt(0);
    let [maybeLocal] = element.tag.split('.');
    let isNamedArgument = open === '@';
    let isLocal = element['symbols'].has(maybeLocal);
    let isThisPath = element.tag.indexOf('this.') === 0;
    return isLocal || isNamedArgument || isThisPath;
}
function isComponent(element) {
    let open = element.tag.charAt(0);
    let isPath = element.tag.indexOf('.') > -1;
    let isUpperCase = open === open.toUpperCase() && open !== open.toLowerCase();
    return isUpperCase && !isPath || isDynamicComponent(element);
}
function assertIsSimplePath(path, loc, context) {
    if (!isSimplePath(path)) {
        throw new _syntax.SyntaxError(`\`${path.original}\` is not a valid name for a ${context} on line ${loc.start.line}.`, path.loc);
    }
}
function assertValidYield(statement) {
    let { pairs } = statement.hash;
    if (pairs.length === 1 && pairs[0].key !== 'to' || pairs.length > 1) {
        throw new _syntax.SyntaxError(`yield only takes a single named argument: 'to'`, statement.loc);
    } else if (pairs.length === 1 && pairs[0].value.type !== 'StringLiteral') {
        throw new _syntax.SyntaxError(`you can only yield to a literal value`, statement.loc);
    } else if (pairs.length === 0) {
        return 'default';
    } else {
        return pairs[0].value.value;
    }
}
function assertValidPartial(statement) {
    let { params, hash, escaped, loc } = statement;
    if (params && params.length !== 1) {
        throw new _syntax.SyntaxError(`Partial found with no arguments. You must specify a template name. (on line ${loc.start.line})`, statement.loc);
    } else if (hash && hash.pairs.length > 0) {
        throw new _syntax.SyntaxError(`partial does not take any named arguments (on line ${loc.start.line})`, statement.loc);
    } else if (!escaped) {
        throw new _syntax.SyntaxError(`{{{partial ...}}} is not supported, please use {{partial ...}} instead (on line ${loc.start.line})`, statement.loc);
    }
    return params;
}
function assertValidHasBlockUsage(type, call) {
    let { params, hash, loc } = call;
    if (hash && hash.pairs.length > 0) {
        throw new _syntax.SyntaxError(`${type} does not take any named arguments`, call.loc);
    }
    if (params.length === 0) {
        return 'default';
    } else if (params.length === 1) {
        let param = params[0];
        if (param.type === 'StringLiteral') {
            return param.value;
        } else {
            throw new _syntax.SyntaxError(`you can only yield to a literal value (on line ${loc.start.line})`, call.loc);
        }
    } else {
        throw new _syntax.SyntaxError(`${type} only takes a single positional argument (on line ${loc.start.line})`, call.loc);
    }
}
function assertValidDebuggerUsage(statement) {
    let { params, hash } = statement;
    if (hash && hash.pairs.length > 0) {
        throw new _syntax.SyntaxError(`debugger does not take any named arguments`, statement.loc);
    }
    if (params.length === 0) {
        return 'default';
    } else {
        throw new _syntax.SyntaxError(`debugger does not take any positional arguments`, statement.loc);
    }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVtcGxhdGUtY29tcGlsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9jb21waWxlci9saWIvdGVtcGxhdGUtY29tcGlsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBLEFBQU8sQUFBMkIsQUFBTSxBQUFvQixBQUFDOzs7O0FBQzdELEFBQU8sQUFBZ0MsQUFBTSxBQUF1QixBQUFDOzs7O0FBQ3JFLEFBQU8sQUFBRSxBQUFNLEFBQVUsQUFBTSxBQUFlLEFBQUM7O0FBQy9DLEFBQU8sQUFBTyxBQUFTLEFBQUUsQUFBVyxBQUFFLEFBQU0sQUFBaUIsQUFBQzs7QUFDOUQsQUFBTyxBQUFFLEFBQWdCLEFBQUUsQUFBTSxBQUFTLEFBQUM7O0FBRTNDLEFBQU8sQUFBRSxBQUFlLEFBQTRDLEFBQU0sQUFBb0IsQUFBQzs7OztBQVEvRixTQUFTLEFBQWMsZUFBQyxBQUFVLE9BQ2hDO1dBQU8sQUFBSyxNQUFDLEFBQU8sWUFBSyxBQUFTLGFBQUksQ0FBQyxBQUFLLE1BQUMsQUFBTyxBQUFDLEFBQ3ZELEFBQUM7QUFFRCxBQUFNO0FBQUMsTUFBTSxBQUFJLHNCQUFHLEFBQUMsQUFBQyxBQUV0QixBQUFNLEFBQUMsQUFBTztNQUFPLEFBQWdCO2tCQVkzQjthQUFVLGFBQUcsQUFBQyxBQUFDLEFBQ2Y7YUFBVyxjQUFhLEFBQUUsQUFBQyxBQUMzQjthQUFPLFVBQWlCLEFBQUUsQUFBQyxBQUMzQjthQUFXLGNBQUcsQUFBSyxBQUFDLEFBeVk5QixBQUFDO0FBdlpDLEFBQU07V0FBQyxBQUFPLFFBQUMsQUFBZ0IsS0FBRSxBQUF3QixTQUN2RDtZQUFJLEFBQWUsa0JBQUcsQUFBSSxBQUFlLEFBQUUsQUFBQyxBQUM1QyxBQUFlO3dCQUFDLEFBQUssTUFBQyxBQUFHLEFBQUMsQUFBQyxBQUUzQjtZQUFJLEFBQVEsV0FBRyxJQUFJLEFBQWdCLEFBQUUsQUFBQyxBQUN0QztZQUFJLEFBQU8s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QyxBQUFDLEFBQ3BGO0FBRUQ7UUFBSSxBQUFNLE9BQUMsQUFBTSxXQUFLLEFBQUMsR0FBRSxBQUN2QjtlQUFPLEFBQVMsQUFBQyxBQUNsQjtXQUFNLEFBQ0w7Y0FBTSxBQUFJLEFBQVcsQUFBQyxBQUFpRCwyRUFBRSxBQUFTLFVBQUMsQUFBRyxBQUFDLEFBQUMsQUFDekYsQUFDSDtBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFRlbXBsYXRlVmlzaXRvciwgeyBBY3Rpb24gfSBmcm9tICcuL3RlbXBsYXRlLXZpc2l0b3InO1xuaW1wb3J0IEphdmFTY3JpcHRDb21waWxlciwgeyBUZW1wbGF0ZSB9IGZyb20gJy4vamF2YXNjcmlwdC1jb21waWxlcic7XG5pbXBvcnQgeyBhc3NlcnQsIE9wdGlvbiB9IGZyb20gJ0BnbGltbWVyL3V0aWwnO1xuaW1wb3J0IHsgQVNULCBpc0xpdGVyYWwsIFN5bnRheEVycm9yIH0gZnJvbSAnQGdsaW1tZXIvc3ludGF4JztcbmltcG9ydCB7IGdldEF0dHJOYW1lc3BhY2UgfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7IE9wYXF1ZSB9IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgU3ltYm9sQWxsb2NhdG9yLCBJbk9wIGFzIFN5bWJvbEluT3AsIE91dE9wIGFzIFN5bWJvbE91dE9wIH0gZnJvbSAnLi9hbGxvY2F0ZS1zeW1ib2xzJztcbmltcG9ydCB7IFBhdGhIZWFkIH0gZnJvbSAnLi9jb21waWxlci1vcHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIENvbXBpbGVPcHRpb25zIHtcbiAgbWV0YTogT3BhcXVlO1xuICBjdXN0b21pemVDb21wb25lbnROYW1lPyh0YWc6IHN0cmluZyk6IHN0cmluZztcbn1cblxuZnVuY3Rpb24gaXNUcnVzdGVkVmFsdWUodmFsdWU6IGFueSkge1xuICByZXR1cm4gdmFsdWUuZXNjYXBlZCAhPT0gdW5kZWZpbmVkICYmICF2YWx1ZS5lc2NhcGVkO1xufVxuXG5leHBvcnQgY29uc3QgVEhJUyA9IDA7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRlbXBsYXRlQ29tcGlsZXIge1xuICBzdGF0aWMgY29tcGlsZShhc3Q6IEFTVC5Qcm9ncmFtLCBvcHRpb25zPzogQ29tcGlsZU9wdGlvbnMpOiBUZW1wbGF0ZSB7XG4gICAgbGV0IHRlbXBsYXRlVmlzaXRvciA9IG5ldyBUZW1wbGF0ZVZpc2l0b3IoKTtcbiAgICB0ZW1wbGF0ZVZpc2l0b3IudmlzaXQoYXN0KTtcblxuICAgIGxldCBjb21waWxlciA9IG5ldyBUZW1wbGF0ZUNvbXBpbGVyKCk7XG4gICAgbGV0IG9wY29kZXM6IFN5bWJvbEluT3BbXSA9IGNvbXBpbGVyLnByb2Nlc3ModGVtcGxhdGVWaXNpdG9yLmFjdGlvbnMpO1xuICAgIGxldCBzeW1ib2xzOiBTeW1ib2xPdXRPcFtdID0gbmV3IFN5bWJvbEFsbG9jYXRvcihvcGNvZGVzKS5wcm9jZXNzKCk7XG5cbiAgICByZXR1cm4gSmF2YVNjcmlwdENvbXBpbGVyLnByb2Nlc3Moc3ltYm9scywgYXN0WydzeW1ib2xzJ10sIG9wdGlvbnMpO1xuICB9XG5cbiAgcHJpdmF0ZSB0ZW1wbGF0ZUlkID0gMDtcbiAgcHJpdmF0ZSB0ZW1wbGF0ZUlkczogbnVtYmVyW10gPSBbXTtcbiAgcHJpdmF0ZSBvcGNvZGVzOiBTeW1ib2xJbk9wW10gPSBbXTtcbiAgcHJpdmF0ZSBpbmNsdWRlTWV0YSA9IGZhbHNlO1xuXG4gIHByb2Nlc3MoYWN0aW9uczogQWN0aW9uW10pOiBTeW1ib2xJbk9wW10ge1xuICAgIGFjdGlvbnMuZm9yRWFjaCgoW25hbWUsIC4uLmFyZ3NdKSA9PiB7XG4gICAgICBpZiAoIXRoaXNbbmFtZV0pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmltcGxlbWVudGVkICR7bmFtZX0gb24gVGVtcGxhdGVDb21waWxlcmApO1xuICAgICAgfVxuICAgICAgKHRoaXNbbmFtZV0gYXMgYW55KSguLi5hcmdzKTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5vcGNvZGVzO1xuICB9XG5cbiAgc3RhcnRQcm9ncmFtKFtwcm9ncmFtXTogW0FTVC5Qcm9ncmFtXSkge1xuICAgIHRoaXMub3Bjb2RlKFsnc3RhcnRQcm9ncmFtJywgcHJvZ3JhbV0sIHByb2dyYW0pO1xuICB9XG5cbiAgZW5kUHJvZ3JhbSgpIHtcbiAgICB0aGlzLm9wY29kZShbJ2VuZFByb2dyYW0nLCBudWxsXSwgbnVsbCk7XG4gIH1cblxuICBzdGFydEJsb2NrKFtwcm9ncmFtXTogW0FTVC5Qcm9ncmFtXSkge1xuICAgIHRoaXMudGVtcGxhdGVJZCsrO1xuICAgIHRoaXMub3Bjb2RlKFsnc3RhcnRCbG9jaycsIHByb2dyYW1dLCBwcm9ncmFtKTtcbiAgfVxuXG4gIGVuZEJsb2NrKCkge1xuICAgIHRoaXMudGVtcGxhdGVJZHMucHVzaCh0aGlzLnRlbXBsYXRlSWQgLSAxKTtcbiAgICB0aGlzLm9wY29kZShbJ2VuZEJsb2NrJywgbnVsbF0sIG51bGwpO1xuICB9XG5cbiAgdGV4dChbYWN0aW9uXTogW0FTVC5UZXh0Tm9kZV0pIHtcbiAgICB0aGlzLm9wY29kZShbJ3RleHQnLCBhY3Rpb24uY2hhcnNdLCBhY3Rpb24pO1xuICB9XG5cbiAgY29tbWVudChbYWN0aW9uXTogW0FTVC5Db21tZW50U3RhdGVtZW50XSkge1xuICAgIHRoaXMub3Bjb2RlKFsnY29tbWVudCcsIGFjdGlvbi52YWx1ZV0sIGFjdGlvbik7XG4gIH1cblxuICBvcGVuRWxlbWVudChbYWN0aW9uXTogW0FTVC5FbGVtZW50Tm9kZV0pIHtcbiAgICBsZXQgYXR0cmlidXRlcyA9IGFjdGlvbi5hdHRyaWJ1dGVzO1xuICAgIGxldCBoYXNTcGxhdCA9IGZhbHNlO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgYXR0ciA9IGF0dHJpYnV0ZXNbaV07XG4gICAgICBpZiAoYXR0ci5uYW1lID09PSAnLi4uYXR0cmlidXRlcycpIHtcbiAgICAgICAgaGFzU3BsYXQgPSB0cnVlO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBsZXQgYWN0aW9uSXNDb21wb25lbnQgPSBmYWxzZTtcblxuICAgIGlmIChpc0R5bmFtaWNDb21wb25lbnQoYWN0aW9uKSkge1xuICAgICAgbGV0IGhlYWQ6IFBhdGhIZWFkLCByZXN0OiBzdHJpbmdbXTtcbiAgICAgIFtoZWFkLCAuLi5yZXN0XSA9IGFjdGlvbi50YWcuc3BsaXQoJy4nKTtcbiAgICAgIGlmIChoZWFkID09PSAndGhpcycpIHtcbiAgICAgICAgaGVhZCA9IDA7XG4gICAgICB9XG4gICAgICB0aGlzLm9wY29kZShbJ2dldCcsIFtoZWFkLCByZXN0XV0pO1xuICAgICAgdGhpcy5vcGNvZGUoWydvcGVuQ29tcG9uZW50JywgYWN0aW9uXSwgYWN0aW9uKTtcbiAgICAgIGFjdGlvbklzQ29tcG9uZW50ID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKGlzQ29tcG9uZW50KGFjdGlvbikpIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnb3BlbkNvbXBvbmVudCcsIGFjdGlvbl0sIGFjdGlvbik7XG4gICAgICBhY3Rpb25Jc0NvbXBvbmVudCA9IHRydWU7XG4gICAgfSBlbHNlIGlmIChoYXNTcGxhdCkge1xuICAgICAgdGhpcy5vcGNvZGUoWydvcGVuU3BsYXR0ZWRFbGVtZW50JywgYWN0aW9uXSwgYWN0aW9uKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5vcGNvZGUoWydvcGVuRWxlbWVudCcsIGFjdGlvbl0sIGFjdGlvbik7XG4gICAgfVxuXG4gICAgbGV0IHR5cGVBdHRyOiBPcHRpb248QVNULkF0dHJOb2RlPiA9IG51bGw7XG4gICAgbGV0IGF0dHJzID0gYWN0aW9uLmF0dHJpYnV0ZXM7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhdHRycy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGF0dHJzW2ldLm5hbWUgPT09ICd0eXBlJykge1xuICAgICAgICB0eXBlQXR0ciA9IGF0dHJzW2ldO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIHRoaXMuYXR0cmlidXRlKFthdHRyc1tpXV0sIGhhc1NwbGF0IHx8IGFjdGlvbklzQ29tcG9uZW50KTtcbiAgICB9XG5cbiAgICBpZiAodHlwZUF0dHIpIHtcbiAgICAgIHRoaXMuYXR0cmlidXRlKFt0eXBlQXR0cl0sIGhhc1NwbGF0IHx8IGFjdGlvbklzQ29tcG9uZW50KTtcbiAgICB9XG5cbiAgICB0aGlzLm9wY29kZShbJ2ZsdXNoRWxlbWVudCcsIGFjdGlvbl0sIG51bGwpO1xuICB9XG5cbiAgY2xvc2VFbGVtZW50KFthY3Rpb25dOiBbQVNULkVsZW1lbnROb2RlXSkge1xuICAgIGlmIChpc0R5bmFtaWNDb21wb25lbnQoYWN0aW9uKSkge1xuICAgICAgdGhpcy5vcGNvZGUoWydjbG9zZUR5bmFtaWNDb21wb25lbnQnLCBhY3Rpb25dLCBhY3Rpb24pO1xuICAgIH0gZWxzZSBpZiAoaXNDb21wb25lbnQoYWN0aW9uKSkge1xuICAgICAgdGhpcy5vcGNvZGUoWydjbG9zZUNvbXBvbmVudCcsIGFjdGlvbl0sIGFjdGlvbik7XG4gICAgfSBlbHNlIGlmIChhY3Rpb24ubW9kaWZpZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWN0aW9uLm1vZGlmaWVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLm1vZGlmaWVyKFthY3Rpb24ubW9kaWZpZXJzW2ldXSk7XG4gICAgICB9XG4gICAgICB0aGlzLm9wY29kZShbJ2Nsb3NlRWxlbWVudCcsIGFjdGlvbl0sIGFjdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnY2xvc2VFbGVtZW50JywgYWN0aW9uXSwgYWN0aW9uKTtcbiAgICB9XG4gIH1cblxuICBhdHRyaWJ1dGUoW2FjdGlvbl06IFtBU1QuQXR0ck5vZGVdLCBpc0NvbXBvbmVudDogYm9vbGVhbikge1xuICAgIGxldCB7IG5hbWUsIHZhbHVlIH0gPSBhY3Rpb247XG5cbiAgICBsZXQgbmFtZXNwYWNlID0gZ2V0QXR0ck5hbWVzcGFjZShuYW1lKTtcbiAgICBsZXQgaXNTdGF0aWMgPSB0aGlzLnByZXBhcmVBdHRyaWJ1dGVWYWx1ZSh2YWx1ZSk7XG5cbiAgICBpZiAobmFtZS5jaGFyQXQoMCkgPT09ICdAJykge1xuICAgICAgLy8gQXJndW1lbnRzXG4gICAgICBpZiAoaXNTdGF0aWMpIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoWydzdGF0aWNBcmcnLCBuYW1lXSwgYWN0aW9uKTtcbiAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLnZhbHVlLnR5cGUgPT09ICdNdXN0YWNoZVN0YXRlbWVudCcpIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoWydkeW5hbWljQXJnJywgbmFtZV0sIGFjdGlvbik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm9wY29kZShbJ2R5bmFtaWNBcmcnLCBuYW1lXSwgYWN0aW9uKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgbGV0IGlzVHJ1c3RpbmcgPSBpc1RydXN0ZWRWYWx1ZSh2YWx1ZSk7XG5cbiAgICAgIGlmIChpc1N0YXRpYyAmJiBuYW1lID09PSAnLi4uYXR0cmlidXRlcycpIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoWydhdHRyU3BsYXQnLCBudWxsXSwgYWN0aW9uKTtcbiAgICAgIH0gZWxzZSBpZiAoaXNTdGF0aWMgJiYgIWlzQ29tcG9uZW50KSB7XG4gICAgICAgIHRoaXMub3Bjb2RlKFsnc3RhdGljQXR0cicsIFtuYW1lLCBuYW1lc3BhY2VdXSwgYWN0aW9uKTtcbiAgICAgIH0gZWxzZSBpZiAoaXNUcnVzdGluZykge1xuICAgICAgICB0aGlzLm9wY29kZShcbiAgICAgICAgICBbaXNDb21wb25lbnQgPyAndHJ1c3RpbmdDb21wb25lbnRBdHRyJyA6ICd0cnVzdGluZ0F0dHInLCBbbmFtZSwgbmFtZXNwYWNlXV0sXG4gICAgICAgICAgYWN0aW9uXG4gICAgICAgICk7XG4gICAgICB9IGVsc2UgaWYgKGFjdGlvbi52YWx1ZS50eXBlID09PSAnTXVzdGFjaGVTdGF0ZW1lbnQnKSB7XG4gICAgICAgIHRoaXMub3Bjb2RlKFtpc0NvbXBvbmVudCA/ICdjb21wb25lbnRBdHRyJyA6ICdkeW5hbWljQXR0cicsIFtuYW1lLCBudWxsXV0sIGFjdGlvbik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm9wY29kZShbaXNDb21wb25lbnQgPyAnY29tcG9uZW50QXR0cicgOiAnZHluYW1pY0F0dHInLCBbbmFtZSwgbmFtZXNwYWNlXV0sIGFjdGlvbik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgbW9kaWZpZXIoW2FjdGlvbl06IFtBU1QuRWxlbWVudE1vZGlmaWVyU3RhdGVtZW50XSkge1xuICAgIGFzc2VydElzU2ltcGxlUGF0aChhY3Rpb24ucGF0aCwgYWN0aW9uLmxvYywgJ21vZGlmaWVyJyk7XG5cbiAgICBsZXQge1xuICAgICAgcGF0aDogeyBwYXJ0cyB9LFxuICAgIH0gPSBhY3Rpb247XG5cbiAgICB0aGlzLnByZXBhcmVIZWxwZXIoYWN0aW9uKTtcbiAgICB0aGlzLm9wY29kZShbJ21vZGlmaWVyJywgcGFydHNbMF1dLCBhY3Rpb24pO1xuICB9XG5cbiAgbXVzdGFjaGUoW2FjdGlvbl06IFtBU1QuTXVzdGFjaGVTdGF0ZW1lbnRdKSB7XG4gICAgbGV0IHsgcGF0aCB9ID0gYWN0aW9uO1xuXG4gICAgaWYgKGlzTGl0ZXJhbChwYXRoKSkge1xuICAgICAgdGhpcy5tdXN0YWNoZUV4cHJlc3Npb24oYWN0aW9uKTtcbiAgICAgIHRoaXMub3Bjb2RlKFsnYXBwZW5kJywgIWFjdGlvbi5lc2NhcGVkXSwgYWN0aW9uKTtcbiAgICB9IGVsc2UgaWYgKGlzWWllbGQocGF0aCkpIHtcbiAgICAgIGxldCB0byA9IGFzc2VydFZhbGlkWWllbGQoYWN0aW9uKTtcbiAgICAgIHRoaXMueWllbGQodG8sIGFjdGlvbik7XG4gICAgfSBlbHNlIGlmIChpc1BhcnRpYWwocGF0aCkpIHtcbiAgICAgIGxldCBwYXJhbXMgPSBhc3NlcnRWYWxpZFBhcnRpYWwoYWN0aW9uKTtcbiAgICAgIHRoaXMucGFydGlhbChwYXJhbXMsIGFjdGlvbik7XG4gICAgfSBlbHNlIGlmIChpc0RlYnVnZ2VyKHBhdGgpKSB7XG4gICAgICBhc3NlcnRWYWxpZERlYnVnZ2VyVXNhZ2UoYWN0aW9uKTtcbiAgICAgIHRoaXMuZGVidWdnZXIoJ2RlYnVnZ2VyJywgYWN0aW9uKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5tdXN0YWNoZUV4cHJlc3Npb24oYWN0aW9uKTtcbiAgICAgIHRoaXMub3Bjb2RlKFsnYXBwZW5kJywgIWFjdGlvbi5lc2NhcGVkXSwgYWN0aW9uKTtcbiAgICB9XG4gIH1cblxuICBibG9jayhbYWN0aW9uIC8qLCBpbmRleCwgY291bnQqL106IFtBU1QuQmxvY2tTdGF0ZW1lbnRdKSB7XG4gICAgdGhpcy5wcmVwYXJlSGVscGVyKGFjdGlvbik7XG4gICAgbGV0IHRlbXBsYXRlSWQgPSB0aGlzLnRlbXBsYXRlSWRzLnBvcCgpITtcbiAgICBsZXQgaW52ZXJzZUlkID0gYWN0aW9uLmludmVyc2UgPT09IG51bGwgPyBudWxsIDogdGhpcy50ZW1wbGF0ZUlkcy5wb3AoKSE7XG4gICAgdGhpcy5vcGNvZGUoWydibG9jaycsIFthY3Rpb24ucGF0aC5wYXJ0c1swXSwgdGVtcGxhdGVJZCwgaW52ZXJzZUlkXV0sIGFjdGlvbik7XG4gIH1cblxuICAvLy8gSW50ZXJuYWwgYWN0aW9ucywgbm90IGZvdW5kIGluIHRoZSBvcmlnaW5hbCBwcm9jZXNzZWQgYWN0aW9uc1xuXG4gIGFyZyhbcGF0aF06IFtBU1QuUGF0aEV4cHJlc3Npb25dKSB7XG4gICAgbGV0IHtcbiAgICAgIHBhcnRzOiBbaGVhZCwgLi4ucmVzdF0sXG4gICAgfSA9IHBhdGg7XG4gICAgdGhpcy5vcGNvZGUoWydnZXQnLCBbYEAke2hlYWR9YCwgcmVzdF1dLCBwYXRoKTtcbiAgfVxuXG4gIG11c3RhY2hlRXhwcmVzc2lvbihleHByOiBBU1QuTXVzdGFjaGVTdGF0ZW1lbnQpIHtcbiAgICBsZXQgeyBwYXRoIH0gPSBleHByO1xuXG4gICAgaWYgKGlzTGl0ZXJhbChwYXRoKSkge1xuICAgICAgdGhpcy5vcGNvZGUoWydsaXRlcmFsJywgcGF0aC52YWx1ZV0sIGV4cHIpO1xuICAgIH0gZWxzZSBpZiAoaXNCdWlsdEluSGVscGVyKHBhdGgpKSB7XG4gICAgICB0aGlzLmJ1aWx0SW5IZWxwZXIoZXhwciBhcyBBU1QuQ2FsbCk7XG4gICAgfSBlbHNlIGlmIChpc0FyZyhwYXRoKSkge1xuICAgICAgdGhpcy5hcmcoW3BhdGhdKTtcbiAgICB9IGVsc2UgaWYgKGlzSGVscGVySW52b2NhdGlvbihleHByKSkge1xuICAgICAgdGhpcy5wcmVwYXJlSGVscGVyKGV4cHIpO1xuICAgICAgdGhpcy5vcGNvZGUoWydoZWxwZXInLCBwYXRoLnBhcnRzWzBdXSwgZXhwcik7XG4gICAgfSBlbHNlIGlmIChwYXRoLnRoaXMpIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnZ2V0JywgWzAsIHBhdGgucGFydHNdXSwgZXhwcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBbaGVhZCwgLi4ucGFydHNdID0gcGF0aC5wYXJ0cztcbiAgICAgIHRoaXMub3Bjb2RlKFsnbWF5YmVHZXQnLCBbaGVhZCwgcGFydHNdXSwgZXhwcik7XG4gICAgfVxuXG4gICAgLy8gfSBlbHNlIGlmIChpc0xvY2FsKHBhdGgsIHRoaXMuc3ltYm9scykpIHtcbiAgICAvLyAgIGxldCBbaGVhZCwgLi4ucGFydHNdID0gcGF0aC5wYXJ0cztcbiAgICAvLyAgIHRoaXMub3Bjb2RlKFsnZ2V0JywgW2hlYWQsIHBhcnRzXV0sIGV4cHIpO1xuICAgIC8vIH0gZWxzZSBpZiAoaXNTaW1wbGVQYXRoKHBhdGgpKSB7XG4gICAgLy8gICB0aGlzLm9wY29kZShbJ3Vua25vd24nLCBwYXRoLnBhcnRzWzBdXSwgZXhwcik7XG4gICAgLy8gfSBlbHNlIHtcbiAgICAvLyAgIHRoaXMub3Bjb2RlKFsnbWF5YmVMb2NhbCcsIHBhdGgucGFydHNdLCBleHByKTtcbiAgICAvLyB9XG4gIH1cblxuICAvLy8gSW50ZXJuYWwgU3ludGF4XG5cbiAgeWllbGQodG86IHN0cmluZywgYWN0aW9uOiBBU1QuTXVzdGFjaGVTdGF0ZW1lbnQpIHtcbiAgICB0aGlzLnByZXBhcmVQYXJhbXMoYWN0aW9uLnBhcmFtcyk7XG4gICAgdGhpcy5vcGNvZGUoWyd5aWVsZCcsIHRvXSwgYWN0aW9uKTtcbiAgfVxuXG4gIGRlYnVnZ2VyKF9uYW1lOiBzdHJpbmcsIGFjdGlvbjogQVNULk11c3RhY2hlU3RhdGVtZW50KSB7XG4gICAgdGhpcy5vcGNvZGUoWydkZWJ1Z2dlcicsIG51bGxdLCBhY3Rpb24pO1xuICB9XG5cbiAgaGFzQmxvY2sobmFtZTogc3RyaW5nLCBhY3Rpb246IEFTVC5DYWxsKSB7XG4gICAgdGhpcy5vcGNvZGUoWydoYXNCbG9jaycsIG5hbWVdLCBhY3Rpb24pO1xuICB9XG5cbiAgaGFzQmxvY2tQYXJhbXMobmFtZTogc3RyaW5nLCBhY3Rpb246IEFTVC5DYWxsKSB7XG4gICAgdGhpcy5vcGNvZGUoWydoYXNCbG9ja1BhcmFtcycsIG5hbWVdLCBhY3Rpb24pO1xuICB9XG5cbiAgcGFydGlhbChfcGFyYW1zOiBBU1QuRXhwcmVzc2lvbltdLCBhY3Rpb246IEFTVC5NdXN0YWNoZVN0YXRlbWVudCkge1xuICAgIHRoaXMucHJlcGFyZVBhcmFtcyhhY3Rpb24ucGFyYW1zKTtcbiAgICB0aGlzLm9wY29kZShbJ3BhcnRpYWwnLCBudWxsXSwgYWN0aW9uKTtcbiAgfVxuXG4gIGJ1aWx0SW5IZWxwZXIoZXhwcjogQVNULkNhbGwpIHtcbiAgICBsZXQgeyBwYXRoIH0gPSBleHByO1xuICAgIGlmIChpc0hhc0Jsb2NrKHBhdGgpKSB7XG4gICAgICBsZXQgbmFtZSA9IGFzc2VydFZhbGlkSGFzQmxvY2tVc2FnZShleHByLnBhdGgub3JpZ2luYWwsIGV4cHIpO1xuICAgICAgdGhpcy5oYXNCbG9jayhuYW1lLCBleHByKTtcbiAgICB9IGVsc2UgaWYgKGlzSGFzQmxvY2tQYXJhbXMocGF0aCkpIHtcbiAgICAgIGxldCBuYW1lID0gYXNzZXJ0VmFsaWRIYXNCbG9ja1VzYWdlKGV4cHIucGF0aC5vcmlnaW5hbCwgZXhwcik7XG4gICAgICB0aGlzLmhhc0Jsb2NrUGFyYW1zKG5hbWUsIGV4cHIpO1xuICAgIH1cbiAgfVxuXG4gIC8vLyBFeHByZXNzaW9ucywgaW52b2tlZCByZWN1cnNpdmVseSBmcm9tIHByZXBhcmVQYXJhbXMgYW5kIHByZXBhcmVIYXNoXG5cbiAgU3ViRXhwcmVzc2lvbihleHByOiBBU1QuU3ViRXhwcmVzc2lvbikge1xuICAgIGlmIChpc0J1aWx0SW5IZWxwZXIoZXhwci5wYXRoKSkge1xuICAgICAgdGhpcy5idWlsdEluSGVscGVyKGV4cHIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnByZXBhcmVIZWxwZXIoZXhwcik7XG4gICAgICB0aGlzLm9wY29kZShbJ2hlbHBlcicsIGV4cHIucGF0aC5wYXJ0c1swXV0sIGV4cHIpO1xuICAgIH1cbiAgfVxuXG4gIFBhdGhFeHByZXNzaW9uKGV4cHI6IEFTVC5QYXRoRXhwcmVzc2lvbikge1xuICAgIGlmIChleHByLmRhdGEpIHtcbiAgICAgIHRoaXMuYXJnKFtleHByXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBbaGVhZCwgLi4ucmVzdF0gPSBleHByLnBhcnRzO1xuXG4gICAgICBpZiAoZXhwci50aGlzKSB7XG4gICAgICAgIHRoaXMub3Bjb2RlKFsnZ2V0JywgWzAsIGV4cHIucGFydHNdXSwgZXhwcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm9wY29kZShbJ2dldCcsIFtoZWFkLCByZXN0XV0sIGV4cHIpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIFN0cmluZ0xpdGVyYWwoYWN0aW9uOiBBU1QuU3RyaW5nTGl0ZXJhbCkge1xuICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIGFjdGlvbi52YWx1ZV0sIGFjdGlvbik7XG4gIH1cblxuICBCb29sZWFuTGl0ZXJhbChhY3Rpb246IEFTVC5Cb29sZWFuTGl0ZXJhbCkge1xuICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIGFjdGlvbi52YWx1ZV0sIGFjdGlvbik7XG4gIH1cblxuICBOdW1iZXJMaXRlcmFsKGFjdGlvbjogQVNULk51bWJlckxpdGVyYWwpIHtcbiAgICB0aGlzLm9wY29kZShbJ2xpdGVyYWwnLCBhY3Rpb24udmFsdWVdLCBhY3Rpb24pO1xuICB9XG5cbiAgTnVsbExpdGVyYWwoYWN0aW9uOiBBU1QuTnVsbExpdGVyYWwpIHtcbiAgICB0aGlzLm9wY29kZShbJ2xpdGVyYWwnLCBhY3Rpb24udmFsdWVdLCBhY3Rpb24pO1xuICB9XG5cbiAgVW5kZWZpbmVkTGl0ZXJhbChhY3Rpb246IEFTVC5VbmRlZmluZWRMaXRlcmFsKSB7XG4gICAgdGhpcy5vcGNvZGUoWydsaXRlcmFsJywgYWN0aW9uLnZhbHVlXSwgYWN0aW9uKTtcbiAgfVxuXG4gIC8vLyBVdGlsaXRpZXNcblxuICBvcGNvZGU8TyBleHRlbmRzIFN5bWJvbEluT3A+KG9wY29kZTogTywgYWN0aW9uOiBPcHRpb248QVNULkJhc2VOb2RlPiA9IG51bGwpIHtcbiAgICAvLyBUT0RPOiBUaGlzIGRvZXNuJ3QgcmVhbGx5IHdvcmtcbiAgICBpZiAodGhpcy5pbmNsdWRlTWV0YSAmJiBhY3Rpb24pIHtcbiAgICAgIChvcGNvZGUgYXMgYW55KS5wdXNoKHRoaXMubWV0YShhY3Rpb24pKTtcbiAgICB9XG5cbiAgICB0aGlzLm9wY29kZXMucHVzaChvcGNvZGUpO1xuICB9XG5cbiAgcHJlcGFyZUhlbHBlcihleHByOiBBU1QuQ2FsbCkge1xuICAgIGFzc2VydElzU2ltcGxlUGF0aChleHByLnBhdGgsIGV4cHIubG9jLCAnaGVscGVyJyk7XG5cbiAgICBsZXQgeyBwYXJhbXMsIGhhc2ggfSA9IGV4cHI7XG5cbiAgICB0aGlzLnByZXBhcmVIYXNoKGhhc2gpO1xuICAgIHRoaXMucHJlcGFyZVBhcmFtcyhwYXJhbXMpO1xuICB9XG5cbiAgcHJlcGFyZVBhcmFtcyhwYXJhbXM6IEFTVC5FeHByZXNzaW9uW10pIHtcbiAgICBpZiAoIXBhcmFtcy5sZW5ndGgpIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIG51bGxdLCBudWxsKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBpID0gcGFyYW1zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBsZXQgcGFyYW0gPSBwYXJhbXNbaV07XG5cbiAgICAgIGFzc2VydCh0aGlzW3BhcmFtLnR5cGVdLCBgVW5pbXBsZW1lbnRlZCAke3BhcmFtLnR5cGV9IG9uIFRlbXBsYXRlQ29tcGlsZXJgKTtcbiAgICAgICh0aGlzW3BhcmFtLnR5cGVdIGFzIGFueSkocGFyYW0pO1xuICAgIH1cblxuICAgIHRoaXMub3Bjb2RlKFsncHJlcGFyZUFycmF5JywgcGFyYW1zLmxlbmd0aF0sIG51bGwpO1xuICB9XG5cbiAgcHJlcGFyZUhhc2goaGFzaDogQVNULkhhc2gpIHtcbiAgICBsZXQgcGFpcnMgPSBoYXNoLnBhaXJzO1xuXG4gICAgaWYgKCFwYWlycy5sZW5ndGgpIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIG51bGxdLCBudWxsKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBpID0gcGFpcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIGxldCB7IGtleSwgdmFsdWUgfSA9IHBhaXJzW2ldO1xuXG4gICAgICBhc3NlcnQodGhpc1t2YWx1ZS50eXBlXSwgYFVuaW1wbGVtZW50ZWQgJHt2YWx1ZS50eXBlfSBvbiBUZW1wbGF0ZUNvbXBpbGVyYCk7XG4gICAgICAodGhpc1t2YWx1ZS50eXBlXSBhcyBhbnkpKHZhbHVlKTtcbiAgICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIGtleV0sIG51bGwpO1xuICAgIH1cblxuICAgIHRoaXMub3Bjb2RlKFsncHJlcGFyZU9iamVjdCcsIHBhaXJzLmxlbmd0aF0sIG51bGwpO1xuICB9XG5cbiAgcHJlcGFyZUF0dHJpYnV0ZVZhbHVlKHZhbHVlOiBBU1QuQXR0ck5vZGVbJ3ZhbHVlJ10pIHtcbiAgICAvLyByZXR1cm5zIHRoZSBzdGF0aWMgdmFsdWUgaWYgdGhlIHZhbHVlIGlzIHN0YXRpY1xuXG4gICAgc3dpdGNoICh2YWx1ZS50eXBlKSB7XG4gICAgICBjYXNlICdUZXh0Tm9kZSc6XG4gICAgICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIHZhbHVlLmNoYXJzXSwgdmFsdWUpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIGNhc2UgJ011c3RhY2hlU3RhdGVtZW50JzpcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVNdXN0YWNoZShbdmFsdWVdKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgY2FzZSAnQ29uY2F0U3RhdGVtZW50JzpcbiAgICAgICAgdGhpcy5wcmVwYXJlQ29uY2F0UGFydHModmFsdWUucGFydHMpO1xuICAgICAgICB0aGlzLm9wY29kZShbJ2NvbmNhdCcsIG51bGxdLCB2YWx1ZSk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBwcmVwYXJlQ29uY2F0UGFydHMocGFydHM6IEFTVC5Db25jYXRTdGF0ZW1lbnRbJ3BhcnRzJ10pIHtcbiAgICBmb3IgKGxldCBpID0gcGFydHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIGxldCBwYXJ0ID0gcGFydHNbaV07XG5cbiAgICAgIGlmIChwYXJ0LnR5cGUgPT09ICdNdXN0YWNoZVN0YXRlbWVudCcpIHtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVNdXN0YWNoZShbcGFydF0pO1xuICAgICAgfSBlbHNlIGlmIChwYXJ0LnR5cGUgPT09ICdUZXh0Tm9kZScpIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoWydsaXRlcmFsJywgcGFydC5jaGFyc10sIG51bGwpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMub3Bjb2RlKFsncHJlcGFyZUFycmF5JywgcGFydHMubGVuZ3RoXSwgbnVsbCk7XG4gIH1cblxuICBhdHRyaWJ1dGVNdXN0YWNoZShbYWN0aW9uXTogW0FTVC5NdXN0YWNoZVN0YXRlbWVudF0pIHtcbiAgICB0aGlzLm11c3RhY2hlRXhwcmVzc2lvbihhY3Rpb24pO1xuICB9XG5cbiAgbWV0YShub2RlOiBBU1QuQmFzZU5vZGUpIHtcbiAgICBsZXQgbG9jID0gbm9kZS5sb2M7XG4gICAgaWYgKCFsb2MpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBsZXQgeyBzb3VyY2UsIHN0YXJ0LCBlbmQgfSA9IGxvYztcbiAgICByZXR1cm4gWydsb2MnLCBbc291cmNlIHx8IG51bGwsIFtzdGFydC5saW5lLCBzdGFydC5jb2x1bW5dLCBbZW5kLmxpbmUsIGVuZC5jb2x1bW5dXV07XG4gIH1cbn1cblxuZnVuY3Rpb24gaXNIZWxwZXJJbnZvY2F0aW9uKFxuICBtdXN0YWNoZTogQVNULk11c3RhY2hlU3RhdGVtZW50XG4pOiBtdXN0YWNoZSBpcyBBU1QuTXVzdGFjaGVTdGF0ZW1lbnQgJiB7IHBhdGg6IEFTVC5QYXRoRXhwcmVzc2lvbiB9IHtcbiAgcmV0dXJuIChcbiAgICAobXVzdGFjaGUucGFyYW1zICYmIG11c3RhY2hlLnBhcmFtcy5sZW5ndGggPiAwKSB8fFxuICAgIChtdXN0YWNoZS5oYXNoICYmIG11c3RhY2hlLmhhc2gucGFpcnMubGVuZ3RoID4gMClcbiAgKTtcbn1cblxuZnVuY3Rpb24gaXNTaW1wbGVQYXRoKHsgcGFydHMgfTogQVNULlBhdGhFeHByZXNzaW9uKTogYm9vbGVhbiB7XG4gIHJldHVybiBwYXJ0cy5sZW5ndGggPT09IDE7XG59XG5cbmZ1bmN0aW9uIGlzWWllbGQocGF0aDogQVNULlBhdGhFeHByZXNzaW9uKSB7XG4gIHJldHVybiBwYXRoLm9yaWdpbmFsID09PSAneWllbGQnO1xufVxuXG5mdW5jdGlvbiBpc1BhcnRpYWwocGF0aDogQVNULlBhdGhFeHByZXNzaW9uKSB7XG4gIHJldHVybiBwYXRoLm9yaWdpbmFsID09PSAncGFydGlhbCc7XG59XG5cbmZ1bmN0aW9uIGlzRGVidWdnZXIocGF0aDogQVNULlBhdGhFeHByZXNzaW9uKSB7XG4gIHJldHVybiBwYXRoLm9yaWdpbmFsID09PSAnZGVidWdnZXInO1xufVxuXG5mdW5jdGlvbiBpc0hhc0Jsb2NrKHBhdGg6IEFTVC5QYXRoRXhwcmVzc2lvbikge1xuICByZXR1cm4gcGF0aC5vcmlnaW5hbCA9PT0gJ2hhcy1ibG9jayc7XG59XG5cbmZ1bmN0aW9uIGlzSGFzQmxvY2tQYXJhbXMocGF0aDogQVNULlBhdGhFeHByZXNzaW9uKSB7XG4gIHJldHVybiBwYXRoLm9yaWdpbmFsID09PSAnaGFzLWJsb2NrLXBhcmFtcyc7XG59XG5cbmZ1bmN0aW9uIGlzQnVpbHRJbkhlbHBlcihwYXRoOiBBU1QuUGF0aEV4cHJlc3Npb24pIHtcbiAgcmV0dXJuIGlzSGFzQmxvY2socGF0aCkgfHwgaXNIYXNCbG9ja1BhcmFtcyhwYXRoKTtcbn1cblxuZnVuY3Rpb24gaXNBcmcocGF0aDogQVNULlBhdGhFeHByZXNzaW9uKTogYm9vbGVhbiB7XG4gIHJldHVybiAhIXBhdGhbJ2RhdGEnXTtcbn1cblxuZnVuY3Rpb24gaXNEeW5hbWljQ29tcG9uZW50KGVsZW1lbnQ6IEFTVC5FbGVtZW50Tm9kZSk6IGJvb2xlYW4ge1xuICBsZXQgb3BlbiA9IGVsZW1lbnQudGFnLmNoYXJBdCgwKTtcblxuICBsZXQgW21heWJlTG9jYWxdID0gZWxlbWVudC50YWcuc3BsaXQoJy4nKTtcbiAgbGV0IGlzTmFtZWRBcmd1bWVudCA9IG9wZW4gPT09ICdAJztcbiAgbGV0IGlzTG9jYWwgPSBlbGVtZW50WydzeW1ib2xzJ10uaGFzKG1heWJlTG9jYWwpO1xuICBsZXQgaXNUaGlzUGF0aCA9IGVsZW1lbnQudGFnLmluZGV4T2YoJ3RoaXMuJykgPT09IDA7XG5cbiAgcmV0dXJuIGlzTG9jYWwgfHwgaXNOYW1lZEFyZ3VtZW50IHx8IGlzVGhpc1BhdGg7XG59XG5cbmZ1bmN0aW9uIGlzQ29tcG9uZW50KGVsZW1lbnQ6IEFTVC5FbGVtZW50Tm9kZSk6IGJvb2xlYW4ge1xuICBsZXQgb3BlbiA9IGVsZW1lbnQudGFnLmNoYXJBdCgwKTtcbiAgbGV0IGlzUGF0aCA9IGVsZW1lbnQudGFnLmluZGV4T2YoJy4nKSA+IC0xO1xuXG4gIGxldCBpc1VwcGVyQ2FzZSA9IG9wZW4gPT09IG9wZW4udG9VcHBlckNhc2UoKSAmJiBvcGVuICE9PSBvcGVuLnRvTG93ZXJDYXNlKCk7XG5cbiAgcmV0dXJuIChpc1VwcGVyQ2FzZSAmJiAhaXNQYXRoKSB8fCBpc0R5bmFtaWNDb21wb25lbnQoZWxlbWVudCk7XG59XG5cbmZ1bmN0aW9uIGFzc2VydElzU2ltcGxlUGF0aChwYXRoOiBBU1QuUGF0aEV4cHJlc3Npb24sIGxvYzogQVNULlNvdXJjZUxvY2F0aW9uLCBjb250ZXh0OiBzdHJpbmcpIHtcbiAgaWYgKCFpc1NpbXBsZVBhdGgocGF0aCkpIHtcbiAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoXG4gICAgICBgXFxgJHtwYXRoLm9yaWdpbmFsfVxcYCBpcyBub3QgYSB2YWxpZCBuYW1lIGZvciBhICR7Y29udGV4dH0gb24gbGluZSAke2xvYy5zdGFydC5saW5lfS5gLFxuICAgICAgcGF0aC5sb2NcbiAgICApO1xuICB9XG59XG5cbmZ1bmN0aW9uIGFzc2VydFZhbGlkWWllbGQoc3RhdGVtZW50OiBBU1QuTXVzdGFjaGVTdGF0ZW1lbnQpOiBzdHJpbmcge1xuICBsZXQgeyBwYWlycyB9ID0gc3RhdGVtZW50Lmhhc2g7XG5cbiAgaWYgKChwYWlycy5sZW5ndGggPT09IDEgJiYgcGFpcnNbMF0ua2V5ICE9PSAndG8nKSB8fCBwYWlycy5sZW5ndGggPiAxKSB7XG4gICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKGB5aWVsZCBvbmx5IHRha2VzIGEgc2luZ2xlIG5hbWVkIGFyZ3VtZW50OiAndG8nYCwgc3RhdGVtZW50LmxvYyk7XG4gIH0gZWxzZSBpZiAocGFpcnMubGVuZ3RoID09PSAxICYmIHBhaXJzWzBdLnZhbHVlLnR5cGUgIT09ICdTdHJpbmdMaXRlcmFsJykge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihgeW91IGNhbiBvbmx5IHlpZWxkIHRvIGEgbGl0ZXJhbCB2YWx1ZWAsIHN0YXRlbWVudC5sb2MpO1xuICB9IGVsc2UgaWYgKHBhaXJzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiAnZGVmYXVsdCc7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIChwYWlyc1swXS52YWx1ZSBhcyBBU1QuU3RyaW5nTGl0ZXJhbCkudmFsdWU7XG4gIH1cbn1cblxuZnVuY3Rpb24gYXNzZXJ0VmFsaWRQYXJ0aWFsKHN0YXRlbWVudDogQVNULk11c3RhY2hlU3RhdGVtZW50KSAvKiA6IGV4cHIgKi8ge1xuICBsZXQgeyBwYXJhbXMsIGhhc2gsIGVzY2FwZWQsIGxvYyB9ID0gc3RhdGVtZW50O1xuXG4gIGlmIChwYXJhbXMgJiYgcGFyYW1zLmxlbmd0aCAhPT0gMSkge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihcbiAgICAgIGBQYXJ0aWFsIGZvdW5kIHdpdGggbm8gYXJndW1lbnRzLiBZb3UgbXVzdCBzcGVjaWZ5IGEgdGVtcGxhdGUgbmFtZS4gKG9uIGxpbmUgJHtcbiAgICAgICAgbG9jLnN0YXJ0LmxpbmVcbiAgICAgIH0pYCxcbiAgICAgIHN0YXRlbWVudC5sb2NcbiAgICApO1xuICB9IGVsc2UgaWYgKGhhc2ggJiYgaGFzaC5wYWlycy5sZW5ndGggPiAwKSB7XG4gICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKFxuICAgICAgYHBhcnRpYWwgZG9lcyBub3QgdGFrZSBhbnkgbmFtZWQgYXJndW1lbnRzIChvbiBsaW5lICR7bG9jLnN0YXJ0LmxpbmV9KWAsXG4gICAgICBzdGF0ZW1lbnQubG9jXG4gICAgKTtcbiAgfSBlbHNlIGlmICghZXNjYXBlZCkge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihcbiAgICAgIGB7e3twYXJ0aWFsIC4uLn19fSBpcyBub3Qgc3VwcG9ydGVkLCBwbGVhc2UgdXNlIHt7cGFydGlhbCAuLi59fSBpbnN0ZWFkIChvbiBsaW5lICR7XG4gICAgICAgIGxvYy5zdGFydC5saW5lXG4gICAgICB9KWAsXG4gICAgICBzdGF0ZW1lbnQubG9jXG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiBwYXJhbXM7XG59XG5cbmZ1bmN0aW9uIGFzc2VydFZhbGlkSGFzQmxvY2tVc2FnZSh0eXBlOiBzdHJpbmcsIGNhbGw6IEFTVC5DYWxsKTogc3RyaW5nIHtcbiAgbGV0IHsgcGFyYW1zLCBoYXNoLCBsb2MgfSA9IGNhbGw7XG5cbiAgaWYgKGhhc2ggJiYgaGFzaC5wYWlycy5sZW5ndGggPiAwKSB7XG4gICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKGAke3R5cGV9IGRvZXMgbm90IHRha2UgYW55IG5hbWVkIGFyZ3VtZW50c2AsIGNhbGwubG9jKTtcbiAgfVxuXG4gIGlmIChwYXJhbXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuICdkZWZhdWx0JztcbiAgfSBlbHNlIGlmIChwYXJhbXMubGVuZ3RoID09PSAxKSB7XG4gICAgbGV0IHBhcmFtID0gcGFyYW1zWzBdO1xuICAgIGlmIChwYXJhbS50eXBlID09PSAnU3RyaW5nTGl0ZXJhbCcpIHtcbiAgICAgIHJldHVybiBwYXJhbS52YWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKFxuICAgICAgICBgeW91IGNhbiBvbmx5IHlpZWxkIHRvIGEgbGl0ZXJhbCB2YWx1ZSAob24gbGluZSAke2xvYy5zdGFydC5saW5lfSlgLFxuICAgICAgICBjYWxsLmxvY1xuICAgICAgKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKFxuICAgICAgYCR7dHlwZX0gb25seSB0YWtlcyBhIHNpbmdsZSBwb3NpdGlvbmFsIGFyZ3VtZW50IChvbiBsaW5lICR7bG9jLnN0YXJ0LmxpbmV9KWAsXG4gICAgICBjYWxsLmxvY1xuICAgICk7XG4gIH1cbn1cblxuZnVuY3Rpb24gYXNzZXJ0VmFsaWREZWJ1Z2dlclVzYWdlKHN0YXRlbWVudDogQVNULk11c3RhY2hlU3RhdGVtZW50KSB7XG4gIGxldCB7IHBhcmFtcywgaGFzaCB9ID0gc3RhdGVtZW50O1xuXG4gIGlmIChoYXNoICYmIGhhc2gucGFpcnMubGVuZ3RoID4gMCkge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihgZGVidWdnZXIgZG9lcyBub3QgdGFrZSBhbnkgbmFtZWQgYXJndW1lbnRzYCwgc3RhdGVtZW50LmxvYyk7XG4gIH1cblxuICBpZiAocGFyYW1zLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiAnZGVmYXVsdCc7XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKGBkZWJ1Z2dlciBkb2VzIG5vdCB0YWtlIGFueSBwb3NpdGlvbmFsIGFyZ3VtZW50c2AsIHN0YXRlbWVudC5sb2MpO1xuICB9XG59XG4iXX0=