function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

import TemplateVisitor from './template-visitor';
import JavaScriptCompiler from './javascript-compiler';
import { assert } from '@glimmer/util';
import { isLiteral, SyntaxError } from '@glimmer/syntax';
import { getAttrNamespace } from './utils';
import { SymbolAllocator } from './allocate-symbols';
function isTrustedValue(value) {
    return value.escaped !== undefined && !value.escaped;
}
export var THIS = 0;

var TemplateCompiler = function () {
    function TemplateCompiler() {
        _classCallCheck(this, TemplateCompiler);

        this.templateId = 0;
        this.templateIds = [];
        this.opcodes = [];
        this.includeMeta = false;
    }

    TemplateCompiler.compile = function compile(ast, options) {
        var templateVisitor = new TemplateVisitor();
        templateVisitor.visit(ast);
        var compiler = new TemplateCompiler();
        var opcodes = compiler.process(templateVisitor.actions);
        var symbols = new SymbolAllocator(opcodes).process();
        return JavaScriptCompiler.process(symbols, ast['symbols'], options);
    };

    TemplateCompiler.prototype.process = function process(actions) {
        var _this = this;

        actions.forEach(function (_ref) {
            var name = _ref[0],
                args = _ref.slice(1);

            if (!_this[name]) {
                throw new Error('Unimplemented ' + name + ' on TemplateCompiler');
            }
            _this[name].apply(_this, args);
        });
        return this.opcodes;
    };

    TemplateCompiler.prototype.startProgram = function startProgram(_ref2) {
        var program = _ref2[0];

        this.opcode(['startProgram', program], program);
    };

    TemplateCompiler.prototype.endProgram = function endProgram() {
        this.opcode(['endProgram', null], null);
    };

    TemplateCompiler.prototype.startBlock = function startBlock(_ref3) {
        var program = _ref3[0];

        this.templateId++;
        this.opcode(['startBlock', program], program);
    };

    TemplateCompiler.prototype.endBlock = function endBlock() {
        this.templateIds.push(this.templateId - 1);
        this.opcode(['endBlock', null], null);
    };

    TemplateCompiler.prototype.text = function text(_ref4) {
        var action = _ref4[0];

        this.opcode(['text', action.chars], action);
    };

    TemplateCompiler.prototype.comment = function comment(_ref5) {
        var action = _ref5[0];

        this.opcode(['comment', action.value], action);
    };

    TemplateCompiler.prototype.openElement = function openElement(_ref6) {
        var action = _ref6[0];

        var attributes = action.attributes;
        var hasSplat = false;
        for (var i = 0; i < attributes.length; i++) {
            var attr = attributes[i];
            if (attr.name === '...attributes') {
                hasSplat = true;
                break;
            }
        }
        var actionIsComponent = false;
        if (isDynamicComponent(action)) {
            var head = void 0,
                rest = void 0;

            var _action$tag$split = action.tag.split('.');

            head = _action$tag$split[0];
            rest = _action$tag$split.slice(1);

            if (head === 'this') {
                head = 0;
            }
            this.opcode(['get', [head, rest]]);
            this.opcode(['openComponent', action], action);
            actionIsComponent = true;
        } else if (isComponent(action)) {
            this.opcode(['openComponent', action], action);
            actionIsComponent = true;
        } else if (hasSplat) {
            this.opcode(['openSplattedElement', action], action);
        } else {
            this.opcode(['openElement', action], action);
        }
        var typeAttr = null;
        var attrs = action.attributes;
        for (var _i = 0; _i < attrs.length; _i++) {
            if (attrs[_i].name === 'type') {
                typeAttr = attrs[_i];
                continue;
            }
            this.attribute([attrs[_i]], hasSplat || actionIsComponent);
        }
        if (typeAttr) {
            this.attribute([typeAttr], hasSplat || actionIsComponent);
        }
        this.opcode(['flushElement', action], null);
    };

    TemplateCompiler.prototype.closeElement = function closeElement(_ref7) {
        var action = _ref7[0];

        if (isDynamicComponent(action)) {
            this.opcode(['closeDynamicComponent', action], action);
        } else if (isComponent(action)) {
            this.opcode(['closeComponent', action], action);
        } else if (action.modifiers.length > 0) {
            for (var i = 0; i < action.modifiers.length; i++) {
                this.modifier([action.modifiers[i]]);
            }
            this.opcode(['closeElement', action], action);
        } else {
            this.opcode(['closeElement', action], action);
        }
    };

    TemplateCompiler.prototype.attribute = function attribute(_ref8, isComponent) {
        var action = _ref8[0];
        var name = action.name,
            value = action.value;

        var namespace = getAttrNamespace(name);
        var isStatic = this.prepareAttributeValue(value);
        if (name.charAt(0) === '@') {
            // Arguments
            if (isStatic) {
                this.opcode(['staticArg', name], action);
            } else if (action.value.type === 'MustacheStatement') {
                this.opcode(['dynamicArg', name], action);
            } else {
                this.opcode(['dynamicArg', name], action);
            }
        } else {
            var isTrusting = isTrustedValue(value);
            if (isStatic && name === '...attributes') {
                this.opcode(['attrSplat', null], action);
            } else if (isStatic && !isComponent) {
                this.opcode(['staticAttr', [name, namespace]], action);
            } else if (isTrusting) {
                this.opcode([isComponent ? 'trustingComponentAttr' : 'trustingAttr', [name, namespace]], action);
            } else if (action.value.type === 'MustacheStatement') {
                this.opcode([isComponent ? 'componentAttr' : 'dynamicAttr', [name, null]], action);
            } else {
                this.opcode([isComponent ? 'componentAttr' : 'dynamicAttr', [name, namespace]], action);
            }
        }
    };

    TemplateCompiler.prototype.modifier = function modifier(_ref9) {
        var action = _ref9[0];

        assertIsSimplePath(action.path, action.loc, 'modifier');
        var parts = action.path.parts;

        this.prepareHelper(action);
        this.opcode(['modifier', parts[0]], action);
    };

    TemplateCompiler.prototype.mustache = function mustache(_ref10) {
        var action = _ref10[0];
        var path = action.path;

        if (isLiteral(path)) {
            this.mustacheExpression(action);
            this.opcode(['append', !action.escaped], action);
        } else if (isYield(path)) {
            var to = assertValidYield(action);
            this.yield(to, action);
        } else if (isPartial(path)) {
            var params = assertValidPartial(action);
            this.partial(params, action);
        } else if (isDebugger(path)) {
            assertValidDebuggerUsage(action);
            this.debugger('debugger', action);
        } else {
            this.mustacheExpression(action);
            this.opcode(['append', !action.escaped], action);
        }
    };

    TemplateCompiler.prototype.block = function block(_ref11) {
        var action /*, index, count*/ = _ref11[0];

        this.prepareHelper(action);
        var templateId = this.templateIds.pop();
        var inverseId = action.inverse === null ? null : this.templateIds.pop();
        this.opcode(['block', [action.path.parts[0], templateId, inverseId]], action);
    };
    /// Internal actions, not found in the original processed actions


    TemplateCompiler.prototype.arg = function arg(_ref12) {
        var path = _ref12[0];

        var _path$parts = path.parts,
            head = _path$parts[0],
            rest = _path$parts.slice(1);

        this.opcode(['get', ['@' + head, rest]], path);
    };

    TemplateCompiler.prototype.mustacheExpression = function mustacheExpression(expr) {
        var path = expr.path;

        if (isLiteral(path)) {
            this.opcode(['literal', path.value], expr);
        } else if (isBuiltInHelper(path)) {
            this.builtInHelper(expr);
        } else if (isArg(path)) {
            this.arg([path]);
        } else if (isHelperInvocation(expr)) {
            this.prepareHelper(expr);
            this.opcode(['helper', path.parts[0]], expr);
        } else if (path.this) {
            this.opcode(['get', [0, path.parts]], expr);
        } else {
            var _path$parts2 = path.parts,
                head = _path$parts2[0],
                parts = _path$parts2.slice(1);

            this.opcode(['maybeGet', [head, parts]], expr);
        }
        // } else if (isLocal(path, this.symbols)) {
        //   let [head, ...parts] = path.parts;
        //   this.opcode(['get', [head, parts]], expr);
        // } else if (isSimplePath(path)) {
        //   this.opcode(['unknown', path.parts[0]], expr);
        // } else {
        //   this.opcode(['maybeLocal', path.parts], expr);
        // }
    };
    /// Internal Syntax


    TemplateCompiler.prototype.yield = function _yield(to, action) {
        this.prepareParams(action.params);
        this.opcode(['yield', to], action);
    };

    TemplateCompiler.prototype.debugger = function _debugger(_name, action) {
        this.opcode(['debugger', null], action);
    };

    TemplateCompiler.prototype.hasBlock = function hasBlock(name, action) {
        this.opcode(['hasBlock', name], action);
    };

    TemplateCompiler.prototype.hasBlockParams = function hasBlockParams(name, action) {
        this.opcode(['hasBlockParams', name], action);
    };

    TemplateCompiler.prototype.partial = function partial(_params, action) {
        this.prepareParams(action.params);
        this.opcode(['partial', null], action);
    };

    TemplateCompiler.prototype.builtInHelper = function builtInHelper(expr) {
        var path = expr.path;

        if (isHasBlock(path)) {
            var name = assertValidHasBlockUsage(expr.path.original, expr);
            this.hasBlock(name, expr);
        } else if (isHasBlockParams(path)) {
            var _name2 = assertValidHasBlockUsage(expr.path.original, expr);
            this.hasBlockParams(_name2, expr);
        }
    };
    /// Expressions, invoked recursively from prepareParams and prepareHash


    TemplateCompiler.prototype.SubExpression = function SubExpression(expr) {
        if (isBuiltInHelper(expr.path)) {
            this.builtInHelper(expr);
        } else {
            this.prepareHelper(expr);
            this.opcode(['helper', expr.path.parts[0]], expr);
        }
    };

    TemplateCompiler.prototype.PathExpression = function PathExpression(expr) {
        if (expr.data) {
            this.arg([expr]);
        } else {
            var _expr$parts = expr.parts,
                head = _expr$parts[0],
                rest = _expr$parts.slice(1);

            if (expr.this) {
                this.opcode(['get', [0, expr.parts]], expr);
            } else {
                this.opcode(['get', [head, rest]], expr);
            }
        }
    };

    TemplateCompiler.prototype.StringLiteral = function StringLiteral(action) {
        this.opcode(['literal', action.value], action);
    };

    TemplateCompiler.prototype.BooleanLiteral = function BooleanLiteral(action) {
        this.opcode(['literal', action.value], action);
    };

    TemplateCompiler.prototype.NumberLiteral = function NumberLiteral(action) {
        this.opcode(['literal', action.value], action);
    };

    TemplateCompiler.prototype.NullLiteral = function NullLiteral(action) {
        this.opcode(['literal', action.value], action);
    };

    TemplateCompiler.prototype.UndefinedLiteral = function UndefinedLiteral(action) {
        this.opcode(['literal', action.value], action);
    };
    /// Utilities


    TemplateCompiler.prototype.opcode = function opcode(_opcode) {
        var action = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

        // TODO: This doesn't really work
        if (this.includeMeta && action) {
            _opcode.push(this.meta(action));
        }
        this.opcodes.push(_opcode);
    };

    TemplateCompiler.prototype.prepareHelper = function prepareHelper(expr) {
        assertIsSimplePath(expr.path, expr.loc, 'helper');
        var params = expr.params,
            hash = expr.hash;

        this.prepareHash(hash);
        this.prepareParams(params);
    };

    TemplateCompiler.prototype.prepareParams = function prepareParams(params) {
        if (!params.length) {
            this.opcode(['literal', null], null);
            return;
        }
        for (var i = params.length - 1; i >= 0; i--) {
            var param = params[i];
            false && assert(this[param.type], 'Unimplemented ' + param.type + ' on TemplateCompiler');

            this[param.type](param);
        }
        this.opcode(['prepareArray', params.length], null);
    };

    TemplateCompiler.prototype.prepareHash = function prepareHash(hash) {
        var pairs = hash.pairs;
        if (!pairs.length) {
            this.opcode(['literal', null], null);
            return;
        }
        for (var i = pairs.length - 1; i >= 0; i--) {
            var _pairs$i = pairs[i],
                key = _pairs$i.key,
                value = _pairs$i.value;

            false && assert(this[value.type], 'Unimplemented ' + value.type + ' on TemplateCompiler');

            this[value.type](value);
            this.opcode(['literal', key], null);
        }
        this.opcode(['prepareObject', pairs.length], null);
    };

    TemplateCompiler.prototype.prepareAttributeValue = function prepareAttributeValue(value) {
        // returns the static value if the value is static
        switch (value.type) {
            case 'TextNode':
                this.opcode(['literal', value.chars], value);
                return true;
            case 'MustacheStatement':
                this.attributeMustache([value]);
                return false;
            case 'ConcatStatement':
                this.prepareConcatParts(value.parts);
                this.opcode(['concat', null], value);
                return false;
        }
    };

    TemplateCompiler.prototype.prepareConcatParts = function prepareConcatParts(parts) {
        for (var i = parts.length - 1; i >= 0; i--) {
            var part = parts[i];
            if (part.type === 'MustacheStatement') {
                this.attributeMustache([part]);
            } else if (part.type === 'TextNode') {
                this.opcode(['literal', part.chars], null);
            }
        }
        this.opcode(['prepareArray', parts.length], null);
    };

    TemplateCompiler.prototype.attributeMustache = function attributeMustache(_ref13) {
        var action = _ref13[0];

        this.mustacheExpression(action);
    };

    TemplateCompiler.prototype.meta = function meta(node) {
        var loc = node.loc;
        if (!loc) {
            return [];
        }
        var source = loc.source,
            start = loc.start,
            end = loc.end;

        return ['loc', [source || null, [start.line, start.column], [end.line, end.column]]];
    };

    return TemplateCompiler;
}();

export default TemplateCompiler;

function isHelperInvocation(mustache) {
    return mustache.params && mustache.params.length > 0 || mustache.hash && mustache.hash.pairs.length > 0;
}
function isSimplePath(_ref14) {
    var parts = _ref14.parts;

    return parts.length === 1;
}
function isYield(path) {
    return path.original === 'yield';
}
function isPartial(path) {
    return path.original === 'partial';
}
function isDebugger(path) {
    return path.original === 'debugger';
}
function isHasBlock(path) {
    return path.original === 'has-block';
}
function isHasBlockParams(path) {
    return path.original === 'has-block-params';
}
function isBuiltInHelper(path) {
    return isHasBlock(path) || isHasBlockParams(path);
}
function isArg(path) {
    return !!path['data'];
}
function isDynamicComponent(element) {
    var open = element.tag.charAt(0);

    var _element$tag$split = element.tag.split('.'),
        maybeLocal = _element$tag$split[0];

    var isNamedArgument = open === '@';
    var isLocal = element['symbols'].has(maybeLocal);
    var isThisPath = element.tag.indexOf('this.') === 0;
    return isLocal || isNamedArgument || isThisPath;
}
function isComponent(element) {
    var open = element.tag.charAt(0);
    var isPath = element.tag.indexOf('.') > -1;
    var isUpperCase = open === open.toUpperCase() && open !== open.toLowerCase();
    return isUpperCase && !isPath || isDynamicComponent(element);
}
function assertIsSimplePath(path, loc, context) {
    if (!isSimplePath(path)) {
        throw new SyntaxError('`' + path.original + '` is not a valid name for a ' + context + ' on line ' + loc.start.line + '.', path.loc);
    }
}
function assertValidYield(statement) {
    var pairs = statement.hash.pairs;

    if (pairs.length === 1 && pairs[0].key !== 'to' || pairs.length > 1) {
        throw new SyntaxError('yield only takes a single named argument: \'to\'', statement.loc);
    } else if (pairs.length === 1 && pairs[0].value.type !== 'StringLiteral') {
        throw new SyntaxError('you can only yield to a literal value', statement.loc);
    } else if (pairs.length === 0) {
        return 'default';
    } else {
        return pairs[0].value.value;
    }
}
function assertValidPartial(statement) {
    var params = statement.params,
        hash = statement.hash,
        escaped = statement.escaped,
        loc = statement.loc;

    if (params && params.length !== 1) {
        throw new SyntaxError('Partial found with no arguments. You must specify a template name. (on line ' + loc.start.line + ')', statement.loc);
    } else if (hash && hash.pairs.length > 0) {
        throw new SyntaxError('partial does not take any named arguments (on line ' + loc.start.line + ')', statement.loc);
    } else if (!escaped) {
        throw new SyntaxError('{{{partial ...}}} is not supported, please use {{partial ...}} instead (on line ' + loc.start.line + ')', statement.loc);
    }
    return params;
}
function assertValidHasBlockUsage(type, call) {
    var params = call.params,
        hash = call.hash,
        loc = call.loc;

    if (hash && hash.pairs.length > 0) {
        throw new SyntaxError(type + ' does not take any named arguments', call.loc);
    }
    if (params.length === 0) {
        return 'default';
    } else if (params.length === 1) {
        var param = params[0];
        if (param.type === 'StringLiteral') {
            return param.value;
        } else {
            throw new SyntaxError('you can only yield to a literal value (on line ' + loc.start.line + ')', call.loc);
        }
    } else {
        throw new SyntaxError(type + ' only takes a single positional argument (on line ' + loc.start.line + ')', call.loc);
    }
}
function assertValidDebuggerUsage(statement) {
    var params = statement.params,
        hash = statement.hash;

    if (hash && hash.pairs.length > 0) {
        throw new SyntaxError('debugger does not take any named arguments', statement.loc);
    }
    if (params.length === 0) {
        return 'default';
    } else {
        throw new SyntaxError('debugger does not take any positional arguments', statement.loc);
    }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVtcGxhdGUtY29tcGlsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9jb21waWxlci9saWIvdGVtcGxhdGUtY29tcGlsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLEFBQTJCLHFCQUFNLEFBQW9CLEFBQUM7QUFDN0QsT0FBTyxBQUFnQyx3QkFBTSxBQUF1QixBQUFDO0FBQ3JFLEFBQU8sU0FBRSxBQUFNLEFBQVUsY0FBTSxBQUFlLEFBQUM7QUFDL0MsQUFBTyxTQUFPLEFBQVMsV0FBRSxBQUFXLEFBQUUsbUJBQU0sQUFBaUIsQUFBQztBQUM5RCxBQUFPLFNBQUUsQUFBZ0IsQUFBRSx3QkFBTSxBQUFTLEFBQUM7QUFFM0MsQUFBTyxTQUFFLEFBQWUsQUFBNEMsdUJBQU0sQUFBb0IsQUFBQztBQVEvRixTQUFTLEFBQWMsZUFBQyxBQUFVLE9BQ2hDO1dBQU8sQUFBSyxNQUFDLEFBQU8sWUFBSyxBQUFTLGFBQUksQ0FBQyxBQUFLLE1BQUMsQUFBTyxBQUFDLEFBQ3ZELEFBQUM7O0FBRUQsQUFBTSxPQUFDLElBQU0sQUFBSSxPQUFHLEFBQUMsQUFBQyxBQUV0QixBQUFNLEFBQUMsQUFBTzs7SUFBZCxBQUFxQixBQUFnQjs7QUFZM0I7O2FBQVUsYUFBRyxBQUFDLEFBQUMsQUFDZjthQUFXLGNBQWEsQUFBRSxBQUFDLEFBQzNCO2FBQU8sVUFBaUIsQUFBRSxBQUFDLEFBQzNCO2FBQVcsY0FBRyxBQUFLLEFBQUMsQUF5WTlCLEFBQUM7QUF2WkMsQUFBTTs7cUJBQUMsQUFBTywyQkFBQyxBQUFnQixLQUFFLEFBQXdCLFNBQ3ZEO1lBQUksQUFBZSxrQkFBRyxJQUFJLEFBQWUsQUFBRSxBQUFDLEFBQzVDLEFBQWU7d0JBQUMsQUFBSyxNQUFDLEFBQUcsQUFBQyxBQUFDLEFBRTNCO1lBQUksQUFBUSxXQUFHLElBQUksQUFBZ0IsQUFBRSxBQUFDLEFBQ3RDO1lBQUksQUFBTyxV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QUksQUFBSSxRQUFJLEFBQUksS0FBQyxBQUFLLE1BQUMsQUFBTSxTQUFHLEFBQUMsR0FBRSxBQUNqQztjQUFNLElBQUksQUFBVyxBQUFDLEFBQTRDLDBEQUFFLEFBQVMsVUFBQyxBQUFHLEFBQUMsQUFBQyxBQUNwRjtBQUVEO1FBQUksQUFBTSxPQUFDLEFBQU0sV0FBSyxBQUFDLEdBQUUsQUFDdkI7ZUFBTyxBQUFTLEFBQUMsQUFDbEI7V0FBTSxBQUNMO2NBQU0sSUFBSSxBQUFXLEFBQUMsQUFBaUQsK0RBQUUsQUFBUyxVQUFDLEFBQUcsQUFBQyxBQUFDLEFBQ3pGLEFBQ0g7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBUZW1wbGF0ZVZpc2l0b3IsIHsgQWN0aW9uIH0gZnJvbSAnLi90ZW1wbGF0ZS12aXNpdG9yJztcbmltcG9ydCBKYXZhU2NyaXB0Q29tcGlsZXIsIHsgVGVtcGxhdGUgfSBmcm9tICcuL2phdmFzY3JpcHQtY29tcGlsZXInO1xuaW1wb3J0IHsgYXNzZXJ0LCBPcHRpb24gfSBmcm9tICdAZ2xpbW1lci91dGlsJztcbmltcG9ydCB7IEFTVCwgaXNMaXRlcmFsLCBTeW50YXhFcnJvciB9IGZyb20gJ0BnbGltbWVyL3N5bnRheCc7XG5pbXBvcnQgeyBnZXRBdHRyTmFtZXNwYWNlIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBPcGFxdWUgfSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcbmltcG9ydCB7IFN5bWJvbEFsbG9jYXRvciwgSW5PcCBhcyBTeW1ib2xJbk9wLCBPdXRPcCBhcyBTeW1ib2xPdXRPcCB9IGZyb20gJy4vYWxsb2NhdGUtc3ltYm9scyc7XG5pbXBvcnQgeyBQYXRoSGVhZCB9IGZyb20gJy4vY29tcGlsZXItb3BzJztcblxuZXhwb3J0IGludGVyZmFjZSBDb21waWxlT3B0aW9ucyB7XG4gIG1ldGE6IE9wYXF1ZTtcbiAgY3VzdG9taXplQ29tcG9uZW50TmFtZT8odGFnOiBzdHJpbmcpOiBzdHJpbmc7XG59XG5cbmZ1bmN0aW9uIGlzVHJ1c3RlZFZhbHVlKHZhbHVlOiBhbnkpIHtcbiAgcmV0dXJuIHZhbHVlLmVzY2FwZWQgIT09IHVuZGVmaW5lZCAmJiAhdmFsdWUuZXNjYXBlZDtcbn1cblxuZXhwb3J0IGNvbnN0IFRISVMgPSAwO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUZW1wbGF0ZUNvbXBpbGVyIHtcbiAgc3RhdGljIGNvbXBpbGUoYXN0OiBBU1QuUHJvZ3JhbSwgb3B0aW9ucz86IENvbXBpbGVPcHRpb25zKTogVGVtcGxhdGUge1xuICAgIGxldCB0ZW1wbGF0ZVZpc2l0b3IgPSBuZXcgVGVtcGxhdGVWaXNpdG9yKCk7XG4gICAgdGVtcGxhdGVWaXNpdG9yLnZpc2l0KGFzdCk7XG5cbiAgICBsZXQgY29tcGlsZXIgPSBuZXcgVGVtcGxhdGVDb21waWxlcigpO1xuICAgIGxldCBvcGNvZGVzOiBTeW1ib2xJbk9wW10gPSBjb21waWxlci5wcm9jZXNzKHRlbXBsYXRlVmlzaXRvci5hY3Rpb25zKTtcbiAgICBsZXQgc3ltYm9sczogU3ltYm9sT3V0T3BbXSA9IG5ldyBTeW1ib2xBbGxvY2F0b3Iob3Bjb2RlcykucHJvY2VzcygpO1xuXG4gICAgcmV0dXJuIEphdmFTY3JpcHRDb21waWxlci5wcm9jZXNzKHN5bWJvbHMsIGFzdFsnc3ltYm9scyddLCBvcHRpb25zKTtcbiAgfVxuXG4gIHByaXZhdGUgdGVtcGxhdGVJZCA9IDA7XG4gIHByaXZhdGUgdGVtcGxhdGVJZHM6IG51bWJlcltdID0gW107XG4gIHByaXZhdGUgb3Bjb2RlczogU3ltYm9sSW5PcFtdID0gW107XG4gIHByaXZhdGUgaW5jbHVkZU1ldGEgPSBmYWxzZTtcblxuICBwcm9jZXNzKGFjdGlvbnM6IEFjdGlvbltdKTogU3ltYm9sSW5PcFtdIHtcbiAgICBhY3Rpb25zLmZvckVhY2goKFtuYW1lLCAuLi5hcmdzXSkgPT4ge1xuICAgICAgaWYgKCF0aGlzW25hbWVdKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5pbXBsZW1lbnRlZCAke25hbWV9IG9uIFRlbXBsYXRlQ29tcGlsZXJgKTtcbiAgICAgIH1cbiAgICAgICh0aGlzW25hbWVdIGFzIGFueSkoLi4uYXJncyk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMub3Bjb2RlcztcbiAgfVxuXG4gIHN0YXJ0UHJvZ3JhbShbcHJvZ3JhbV06IFtBU1QuUHJvZ3JhbV0pIHtcbiAgICB0aGlzLm9wY29kZShbJ3N0YXJ0UHJvZ3JhbScsIHByb2dyYW1dLCBwcm9ncmFtKTtcbiAgfVxuXG4gIGVuZFByb2dyYW0oKSB7XG4gICAgdGhpcy5vcGNvZGUoWydlbmRQcm9ncmFtJywgbnVsbF0sIG51bGwpO1xuICB9XG5cbiAgc3RhcnRCbG9jayhbcHJvZ3JhbV06IFtBU1QuUHJvZ3JhbV0pIHtcbiAgICB0aGlzLnRlbXBsYXRlSWQrKztcbiAgICB0aGlzLm9wY29kZShbJ3N0YXJ0QmxvY2snLCBwcm9ncmFtXSwgcHJvZ3JhbSk7XG4gIH1cblxuICBlbmRCbG9jaygpIHtcbiAgICB0aGlzLnRlbXBsYXRlSWRzLnB1c2godGhpcy50ZW1wbGF0ZUlkIC0gMSk7XG4gICAgdGhpcy5vcGNvZGUoWydlbmRCbG9jaycsIG51bGxdLCBudWxsKTtcbiAgfVxuXG4gIHRleHQoW2FjdGlvbl06IFtBU1QuVGV4dE5vZGVdKSB7XG4gICAgdGhpcy5vcGNvZGUoWyd0ZXh0JywgYWN0aW9uLmNoYXJzXSwgYWN0aW9uKTtcbiAgfVxuXG4gIGNvbW1lbnQoW2FjdGlvbl06IFtBU1QuQ29tbWVudFN0YXRlbWVudF0pIHtcbiAgICB0aGlzLm9wY29kZShbJ2NvbW1lbnQnLCBhY3Rpb24udmFsdWVdLCBhY3Rpb24pO1xuICB9XG5cbiAgb3BlbkVsZW1lbnQoW2FjdGlvbl06IFtBU1QuRWxlbWVudE5vZGVdKSB7XG4gICAgbGV0IGF0dHJpYnV0ZXMgPSBhY3Rpb24uYXR0cmlidXRlcztcbiAgICBsZXQgaGFzU3BsYXQgPSBmYWxzZTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXR0cmlidXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGF0dHIgPSBhdHRyaWJ1dGVzW2ldO1xuICAgICAgaWYgKGF0dHIubmFtZSA9PT0gJy4uLmF0dHJpYnV0ZXMnKSB7XG4gICAgICAgIGhhc1NwbGF0ID0gdHJ1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbGV0IGFjdGlvbklzQ29tcG9uZW50ID0gZmFsc2U7XG5cbiAgICBpZiAoaXNEeW5hbWljQ29tcG9uZW50KGFjdGlvbikpIHtcbiAgICAgIGxldCBoZWFkOiBQYXRoSGVhZCwgcmVzdDogc3RyaW5nW107XG4gICAgICBbaGVhZCwgLi4ucmVzdF0gPSBhY3Rpb24udGFnLnNwbGl0KCcuJyk7XG4gICAgICBpZiAoaGVhZCA9PT0gJ3RoaXMnKSB7XG4gICAgICAgIGhlYWQgPSAwO1xuICAgICAgfVxuICAgICAgdGhpcy5vcGNvZGUoWydnZXQnLCBbaGVhZCwgcmVzdF1dKTtcbiAgICAgIHRoaXMub3Bjb2RlKFsnb3BlbkNvbXBvbmVudCcsIGFjdGlvbl0sIGFjdGlvbik7XG4gICAgICBhY3Rpb25Jc0NvbXBvbmVudCA9IHRydWU7XG4gICAgfSBlbHNlIGlmIChpc0NvbXBvbmVudChhY3Rpb24pKSB7XG4gICAgICB0aGlzLm9wY29kZShbJ29wZW5Db21wb25lbnQnLCBhY3Rpb25dLCBhY3Rpb24pO1xuICAgICAgYWN0aW9uSXNDb21wb25lbnQgPSB0cnVlO1xuICAgIH0gZWxzZSBpZiAoaGFzU3BsYXQpIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnb3BlblNwbGF0dGVkRWxlbWVudCcsIGFjdGlvbl0sIGFjdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnb3BlbkVsZW1lbnQnLCBhY3Rpb25dLCBhY3Rpb24pO1xuICAgIH1cblxuICAgIGxldCB0eXBlQXR0cjogT3B0aW9uPEFTVC5BdHRyTm9kZT4gPSBudWxsO1xuICAgIGxldCBhdHRycyA9IGFjdGlvbi5hdHRyaWJ1dGVzO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXR0cnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChhdHRyc1tpXS5uYW1lID09PSAndHlwZScpIHtcbiAgICAgICAgdHlwZUF0dHIgPSBhdHRyc1tpXTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICB0aGlzLmF0dHJpYnV0ZShbYXR0cnNbaV1dLCBoYXNTcGxhdCB8fCBhY3Rpb25Jc0NvbXBvbmVudCk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVBdHRyKSB7XG4gICAgICB0aGlzLmF0dHJpYnV0ZShbdHlwZUF0dHJdLCBoYXNTcGxhdCB8fCBhY3Rpb25Jc0NvbXBvbmVudCk7XG4gICAgfVxuXG4gICAgdGhpcy5vcGNvZGUoWydmbHVzaEVsZW1lbnQnLCBhY3Rpb25dLCBudWxsKTtcbiAgfVxuXG4gIGNsb3NlRWxlbWVudChbYWN0aW9uXTogW0FTVC5FbGVtZW50Tm9kZV0pIHtcbiAgICBpZiAoaXNEeW5hbWljQ29tcG9uZW50KGFjdGlvbikpIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnY2xvc2VEeW5hbWljQ29tcG9uZW50JywgYWN0aW9uXSwgYWN0aW9uKTtcbiAgICB9IGVsc2UgaWYgKGlzQ29tcG9uZW50KGFjdGlvbikpIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnY2xvc2VDb21wb25lbnQnLCBhY3Rpb25dLCBhY3Rpb24pO1xuICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1vZGlmaWVycy5sZW5ndGggPiAwKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFjdGlvbi5tb2RpZmllcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcy5tb2RpZmllcihbYWN0aW9uLm1vZGlmaWVyc1tpXV0pO1xuICAgICAgfVxuICAgICAgdGhpcy5vcGNvZGUoWydjbG9zZUVsZW1lbnQnLCBhY3Rpb25dLCBhY3Rpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm9wY29kZShbJ2Nsb3NlRWxlbWVudCcsIGFjdGlvbl0sIGFjdGlvbik7XG4gICAgfVxuICB9XG5cbiAgYXR0cmlidXRlKFthY3Rpb25dOiBbQVNULkF0dHJOb2RlXSwgaXNDb21wb25lbnQ6IGJvb2xlYW4pIHtcbiAgICBsZXQgeyBuYW1lLCB2YWx1ZSB9ID0gYWN0aW9uO1xuXG4gICAgbGV0IG5hbWVzcGFjZSA9IGdldEF0dHJOYW1lc3BhY2UobmFtZSk7XG4gICAgbGV0IGlzU3RhdGljID0gdGhpcy5wcmVwYXJlQXR0cmlidXRlVmFsdWUodmFsdWUpO1xuXG4gICAgaWYgKG5hbWUuY2hhckF0KDApID09PSAnQCcpIHtcbiAgICAgIC8vIEFyZ3VtZW50c1xuICAgICAgaWYgKGlzU3RhdGljKSB7XG4gICAgICAgIHRoaXMub3Bjb2RlKFsnc3RhdGljQXJnJywgbmFtZV0sIGFjdGlvbik7XG4gICAgICB9IGVsc2UgaWYgKGFjdGlvbi52YWx1ZS50eXBlID09PSAnTXVzdGFjaGVTdGF0ZW1lbnQnKSB7XG4gICAgICAgIHRoaXMub3Bjb2RlKFsnZHluYW1pY0FyZycsIG5hbWVdLCBhY3Rpb24pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoWydkeW5hbWljQXJnJywgbmFtZV0sIGFjdGlvbik7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBpc1RydXN0aW5nID0gaXNUcnVzdGVkVmFsdWUodmFsdWUpO1xuXG4gICAgICBpZiAoaXNTdGF0aWMgJiYgbmFtZSA9PT0gJy4uLmF0dHJpYnV0ZXMnKSB7XG4gICAgICAgIHRoaXMub3Bjb2RlKFsnYXR0clNwbGF0JywgbnVsbF0sIGFjdGlvbik7XG4gICAgICB9IGVsc2UgaWYgKGlzU3RhdGljICYmICFpc0NvbXBvbmVudCkge1xuICAgICAgICB0aGlzLm9wY29kZShbJ3N0YXRpY0F0dHInLCBbbmFtZSwgbmFtZXNwYWNlXV0sIGFjdGlvbik7XG4gICAgICB9IGVsc2UgaWYgKGlzVHJ1c3RpbmcpIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoXG4gICAgICAgICAgW2lzQ29tcG9uZW50ID8gJ3RydXN0aW5nQ29tcG9uZW50QXR0cicgOiAndHJ1c3RpbmdBdHRyJywgW25hbWUsIG5hbWVzcGFjZV1dLFxuICAgICAgICAgIGFjdGlvblxuICAgICAgICApO1xuICAgICAgfSBlbHNlIGlmIChhY3Rpb24udmFsdWUudHlwZSA9PT0gJ011c3RhY2hlU3RhdGVtZW50Jykge1xuICAgICAgICB0aGlzLm9wY29kZShbaXNDb21wb25lbnQgPyAnY29tcG9uZW50QXR0cicgOiAnZHluYW1pY0F0dHInLCBbbmFtZSwgbnVsbF1dLCBhY3Rpb24pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoW2lzQ29tcG9uZW50ID8gJ2NvbXBvbmVudEF0dHInIDogJ2R5bmFtaWNBdHRyJywgW25hbWUsIG5hbWVzcGFjZV1dLCBhY3Rpb24pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIG1vZGlmaWVyKFthY3Rpb25dOiBbQVNULkVsZW1lbnRNb2RpZmllclN0YXRlbWVudF0pIHtcbiAgICBhc3NlcnRJc1NpbXBsZVBhdGgoYWN0aW9uLnBhdGgsIGFjdGlvbi5sb2MsICdtb2RpZmllcicpO1xuXG4gICAgbGV0IHtcbiAgICAgIHBhdGg6IHsgcGFydHMgfSxcbiAgICB9ID0gYWN0aW9uO1xuXG4gICAgdGhpcy5wcmVwYXJlSGVscGVyKGFjdGlvbik7XG4gICAgdGhpcy5vcGNvZGUoWydtb2RpZmllcicsIHBhcnRzWzBdXSwgYWN0aW9uKTtcbiAgfVxuXG4gIG11c3RhY2hlKFthY3Rpb25dOiBbQVNULk11c3RhY2hlU3RhdGVtZW50XSkge1xuICAgIGxldCB7IHBhdGggfSA9IGFjdGlvbjtcblxuICAgIGlmIChpc0xpdGVyYWwocGF0aCkpIHtcbiAgICAgIHRoaXMubXVzdGFjaGVFeHByZXNzaW9uKGFjdGlvbik7XG4gICAgICB0aGlzLm9wY29kZShbJ2FwcGVuZCcsICFhY3Rpb24uZXNjYXBlZF0sIGFjdGlvbik7XG4gICAgfSBlbHNlIGlmIChpc1lpZWxkKHBhdGgpKSB7XG4gICAgICBsZXQgdG8gPSBhc3NlcnRWYWxpZFlpZWxkKGFjdGlvbik7XG4gICAgICB0aGlzLnlpZWxkKHRvLCBhY3Rpb24pO1xuICAgIH0gZWxzZSBpZiAoaXNQYXJ0aWFsKHBhdGgpKSB7XG4gICAgICBsZXQgcGFyYW1zID0gYXNzZXJ0VmFsaWRQYXJ0aWFsKGFjdGlvbik7XG4gICAgICB0aGlzLnBhcnRpYWwocGFyYW1zLCBhY3Rpb24pO1xuICAgIH0gZWxzZSBpZiAoaXNEZWJ1Z2dlcihwYXRoKSkge1xuICAgICAgYXNzZXJ0VmFsaWREZWJ1Z2dlclVzYWdlKGFjdGlvbik7XG4gICAgICB0aGlzLmRlYnVnZ2VyKCdkZWJ1Z2dlcicsIGFjdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubXVzdGFjaGVFeHByZXNzaW9uKGFjdGlvbik7XG4gICAgICB0aGlzLm9wY29kZShbJ2FwcGVuZCcsICFhY3Rpb24uZXNjYXBlZF0sIGFjdGlvbik7XG4gICAgfVxuICB9XG5cbiAgYmxvY2soW2FjdGlvbiAvKiwgaW5kZXgsIGNvdW50Ki9dOiBbQVNULkJsb2NrU3RhdGVtZW50XSkge1xuICAgIHRoaXMucHJlcGFyZUhlbHBlcihhY3Rpb24pO1xuICAgIGxldCB0ZW1wbGF0ZUlkID0gdGhpcy50ZW1wbGF0ZUlkcy5wb3AoKSE7XG4gICAgbGV0IGludmVyc2VJZCA9IGFjdGlvbi5pbnZlcnNlID09PSBudWxsID8gbnVsbCA6IHRoaXMudGVtcGxhdGVJZHMucG9wKCkhO1xuICAgIHRoaXMub3Bjb2RlKFsnYmxvY2snLCBbYWN0aW9uLnBhdGgucGFydHNbMF0sIHRlbXBsYXRlSWQsIGludmVyc2VJZF1dLCBhY3Rpb24pO1xuICB9XG5cbiAgLy8vIEludGVybmFsIGFjdGlvbnMsIG5vdCBmb3VuZCBpbiB0aGUgb3JpZ2luYWwgcHJvY2Vzc2VkIGFjdGlvbnNcblxuICBhcmcoW3BhdGhdOiBbQVNULlBhdGhFeHByZXNzaW9uXSkge1xuICAgIGxldCB7XG4gICAgICBwYXJ0czogW2hlYWQsIC4uLnJlc3RdLFxuICAgIH0gPSBwYXRoO1xuICAgIHRoaXMub3Bjb2RlKFsnZ2V0JywgW2BAJHtoZWFkfWAsIHJlc3RdXSwgcGF0aCk7XG4gIH1cblxuICBtdXN0YWNoZUV4cHJlc3Npb24oZXhwcjogQVNULk11c3RhY2hlU3RhdGVtZW50KSB7XG4gICAgbGV0IHsgcGF0aCB9ID0gZXhwcjtcblxuICAgIGlmIChpc0xpdGVyYWwocGF0aCkpIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIHBhdGgudmFsdWVdLCBleHByKTtcbiAgICB9IGVsc2UgaWYgKGlzQnVpbHRJbkhlbHBlcihwYXRoKSkge1xuICAgICAgdGhpcy5idWlsdEluSGVscGVyKGV4cHIgYXMgQVNULkNhbGwpO1xuICAgIH0gZWxzZSBpZiAoaXNBcmcocGF0aCkpIHtcbiAgICAgIHRoaXMuYXJnKFtwYXRoXSk7XG4gICAgfSBlbHNlIGlmIChpc0hlbHBlckludm9jYXRpb24oZXhwcikpIHtcbiAgICAgIHRoaXMucHJlcGFyZUhlbHBlcihleHByKTtcbiAgICAgIHRoaXMub3Bjb2RlKFsnaGVscGVyJywgcGF0aC5wYXJ0c1swXV0sIGV4cHIpO1xuICAgIH0gZWxzZSBpZiAocGF0aC50aGlzKSB7XG4gICAgICB0aGlzLm9wY29kZShbJ2dldCcsIFswLCBwYXRoLnBhcnRzXV0sIGV4cHIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgW2hlYWQsIC4uLnBhcnRzXSA9IHBhdGgucGFydHM7XG4gICAgICB0aGlzLm9wY29kZShbJ21heWJlR2V0JywgW2hlYWQsIHBhcnRzXV0sIGV4cHIpO1xuICAgIH1cblxuICAgIC8vIH0gZWxzZSBpZiAoaXNMb2NhbChwYXRoLCB0aGlzLnN5bWJvbHMpKSB7XG4gICAgLy8gICBsZXQgW2hlYWQsIC4uLnBhcnRzXSA9IHBhdGgucGFydHM7XG4gICAgLy8gICB0aGlzLm9wY29kZShbJ2dldCcsIFtoZWFkLCBwYXJ0c11dLCBleHByKTtcbiAgICAvLyB9IGVsc2UgaWYgKGlzU2ltcGxlUGF0aChwYXRoKSkge1xuICAgIC8vICAgdGhpcy5vcGNvZGUoWyd1bmtub3duJywgcGF0aC5wYXJ0c1swXV0sIGV4cHIpO1xuICAgIC8vIH0gZWxzZSB7XG4gICAgLy8gICB0aGlzLm9wY29kZShbJ21heWJlTG9jYWwnLCBwYXRoLnBhcnRzXSwgZXhwcik7XG4gICAgLy8gfVxuICB9XG5cbiAgLy8vIEludGVybmFsIFN5bnRheFxuXG4gIHlpZWxkKHRvOiBzdHJpbmcsIGFjdGlvbjogQVNULk11c3RhY2hlU3RhdGVtZW50KSB7XG4gICAgdGhpcy5wcmVwYXJlUGFyYW1zKGFjdGlvbi5wYXJhbXMpO1xuICAgIHRoaXMub3Bjb2RlKFsneWllbGQnLCB0b10sIGFjdGlvbik7XG4gIH1cblxuICBkZWJ1Z2dlcihfbmFtZTogc3RyaW5nLCBhY3Rpb246IEFTVC5NdXN0YWNoZVN0YXRlbWVudCkge1xuICAgIHRoaXMub3Bjb2RlKFsnZGVidWdnZXInLCBudWxsXSwgYWN0aW9uKTtcbiAgfVxuXG4gIGhhc0Jsb2NrKG5hbWU6IHN0cmluZywgYWN0aW9uOiBBU1QuQ2FsbCkge1xuICAgIHRoaXMub3Bjb2RlKFsnaGFzQmxvY2snLCBuYW1lXSwgYWN0aW9uKTtcbiAgfVxuXG4gIGhhc0Jsb2NrUGFyYW1zKG5hbWU6IHN0cmluZywgYWN0aW9uOiBBU1QuQ2FsbCkge1xuICAgIHRoaXMub3Bjb2RlKFsnaGFzQmxvY2tQYXJhbXMnLCBuYW1lXSwgYWN0aW9uKTtcbiAgfVxuXG4gIHBhcnRpYWwoX3BhcmFtczogQVNULkV4cHJlc3Npb25bXSwgYWN0aW9uOiBBU1QuTXVzdGFjaGVTdGF0ZW1lbnQpIHtcbiAgICB0aGlzLnByZXBhcmVQYXJhbXMoYWN0aW9uLnBhcmFtcyk7XG4gICAgdGhpcy5vcGNvZGUoWydwYXJ0aWFsJywgbnVsbF0sIGFjdGlvbik7XG4gIH1cblxuICBidWlsdEluSGVscGVyKGV4cHI6IEFTVC5DYWxsKSB7XG4gICAgbGV0IHsgcGF0aCB9ID0gZXhwcjtcbiAgICBpZiAoaXNIYXNCbG9jayhwYXRoKSkge1xuICAgICAgbGV0IG5hbWUgPSBhc3NlcnRWYWxpZEhhc0Jsb2NrVXNhZ2UoZXhwci5wYXRoLm9yaWdpbmFsLCBleHByKTtcbiAgICAgIHRoaXMuaGFzQmxvY2sobmFtZSwgZXhwcik7XG4gICAgfSBlbHNlIGlmIChpc0hhc0Jsb2NrUGFyYW1zKHBhdGgpKSB7XG4gICAgICBsZXQgbmFtZSA9IGFzc2VydFZhbGlkSGFzQmxvY2tVc2FnZShleHByLnBhdGgub3JpZ2luYWwsIGV4cHIpO1xuICAgICAgdGhpcy5oYXNCbG9ja1BhcmFtcyhuYW1lLCBleHByKTtcbiAgICB9XG4gIH1cblxuICAvLy8gRXhwcmVzc2lvbnMsIGludm9rZWQgcmVjdXJzaXZlbHkgZnJvbSBwcmVwYXJlUGFyYW1zIGFuZCBwcmVwYXJlSGFzaFxuXG4gIFN1YkV4cHJlc3Npb24oZXhwcjogQVNULlN1YkV4cHJlc3Npb24pIHtcbiAgICBpZiAoaXNCdWlsdEluSGVscGVyKGV4cHIucGF0aCkpIHtcbiAgICAgIHRoaXMuYnVpbHRJbkhlbHBlcihleHByKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5wcmVwYXJlSGVscGVyKGV4cHIpO1xuICAgICAgdGhpcy5vcGNvZGUoWydoZWxwZXInLCBleHByLnBhdGgucGFydHNbMF1dLCBleHByKTtcbiAgICB9XG4gIH1cblxuICBQYXRoRXhwcmVzc2lvbihleHByOiBBU1QuUGF0aEV4cHJlc3Npb24pIHtcbiAgICBpZiAoZXhwci5kYXRhKSB7XG4gICAgICB0aGlzLmFyZyhbZXhwcl0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgW2hlYWQsIC4uLnJlc3RdID0gZXhwci5wYXJ0cztcblxuICAgICAgaWYgKGV4cHIudGhpcykge1xuICAgICAgICB0aGlzLm9wY29kZShbJ2dldCcsIFswLCBleHByLnBhcnRzXV0sIGV4cHIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoWydnZXQnLCBbaGVhZCwgcmVzdF1dLCBleHByKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBTdHJpbmdMaXRlcmFsKGFjdGlvbjogQVNULlN0cmluZ0xpdGVyYWwpIHtcbiAgICB0aGlzLm9wY29kZShbJ2xpdGVyYWwnLCBhY3Rpb24udmFsdWVdLCBhY3Rpb24pO1xuICB9XG5cbiAgQm9vbGVhbkxpdGVyYWwoYWN0aW9uOiBBU1QuQm9vbGVhbkxpdGVyYWwpIHtcbiAgICB0aGlzLm9wY29kZShbJ2xpdGVyYWwnLCBhY3Rpb24udmFsdWVdLCBhY3Rpb24pO1xuICB9XG5cbiAgTnVtYmVyTGl0ZXJhbChhY3Rpb246IEFTVC5OdW1iZXJMaXRlcmFsKSB7XG4gICAgdGhpcy5vcGNvZGUoWydsaXRlcmFsJywgYWN0aW9uLnZhbHVlXSwgYWN0aW9uKTtcbiAgfVxuXG4gIE51bGxMaXRlcmFsKGFjdGlvbjogQVNULk51bGxMaXRlcmFsKSB7XG4gICAgdGhpcy5vcGNvZGUoWydsaXRlcmFsJywgYWN0aW9uLnZhbHVlXSwgYWN0aW9uKTtcbiAgfVxuXG4gIFVuZGVmaW5lZExpdGVyYWwoYWN0aW9uOiBBU1QuVW5kZWZpbmVkTGl0ZXJhbCkge1xuICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIGFjdGlvbi52YWx1ZV0sIGFjdGlvbik7XG4gIH1cblxuICAvLy8gVXRpbGl0aWVzXG5cbiAgb3Bjb2RlPE8gZXh0ZW5kcyBTeW1ib2xJbk9wPihvcGNvZGU6IE8sIGFjdGlvbjogT3B0aW9uPEFTVC5CYXNlTm9kZT4gPSBudWxsKSB7XG4gICAgLy8gVE9ETzogVGhpcyBkb2Vzbid0IHJlYWxseSB3b3JrXG4gICAgaWYgKHRoaXMuaW5jbHVkZU1ldGEgJiYgYWN0aW9uKSB7XG4gICAgICAob3Bjb2RlIGFzIGFueSkucHVzaCh0aGlzLm1ldGEoYWN0aW9uKSk7XG4gICAgfVxuXG4gICAgdGhpcy5vcGNvZGVzLnB1c2gob3Bjb2RlKTtcbiAgfVxuXG4gIHByZXBhcmVIZWxwZXIoZXhwcjogQVNULkNhbGwpIHtcbiAgICBhc3NlcnRJc1NpbXBsZVBhdGgoZXhwci5wYXRoLCBleHByLmxvYywgJ2hlbHBlcicpO1xuXG4gICAgbGV0IHsgcGFyYW1zLCBoYXNoIH0gPSBleHByO1xuXG4gICAgdGhpcy5wcmVwYXJlSGFzaChoYXNoKTtcbiAgICB0aGlzLnByZXBhcmVQYXJhbXMocGFyYW1zKTtcbiAgfVxuXG4gIHByZXBhcmVQYXJhbXMocGFyYW1zOiBBU1QuRXhwcmVzc2lvbltdKSB7XG4gICAgaWYgKCFwYXJhbXMubGVuZ3RoKSB7XG4gICAgICB0aGlzLm9wY29kZShbJ2xpdGVyYWwnLCBudWxsXSwgbnVsbCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZm9yIChsZXQgaSA9IHBhcmFtcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgbGV0IHBhcmFtID0gcGFyYW1zW2ldO1xuXG4gICAgICBhc3NlcnQodGhpc1twYXJhbS50eXBlXSwgYFVuaW1wbGVtZW50ZWQgJHtwYXJhbS50eXBlfSBvbiBUZW1wbGF0ZUNvbXBpbGVyYCk7XG4gICAgICAodGhpc1twYXJhbS50eXBlXSBhcyBhbnkpKHBhcmFtKTtcbiAgICB9XG5cbiAgICB0aGlzLm9wY29kZShbJ3ByZXBhcmVBcnJheScsIHBhcmFtcy5sZW5ndGhdLCBudWxsKTtcbiAgfVxuXG4gIHByZXBhcmVIYXNoKGhhc2g6IEFTVC5IYXNoKSB7XG4gICAgbGV0IHBhaXJzID0gaGFzaC5wYWlycztcblxuICAgIGlmICghcGFpcnMubGVuZ3RoKSB7XG4gICAgICB0aGlzLm9wY29kZShbJ2xpdGVyYWwnLCBudWxsXSwgbnVsbCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZm9yIChsZXQgaSA9IHBhaXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBsZXQgeyBrZXksIHZhbHVlIH0gPSBwYWlyc1tpXTtcblxuICAgICAgYXNzZXJ0KHRoaXNbdmFsdWUudHlwZV0sIGBVbmltcGxlbWVudGVkICR7dmFsdWUudHlwZX0gb24gVGVtcGxhdGVDb21waWxlcmApO1xuICAgICAgKHRoaXNbdmFsdWUudHlwZV0gYXMgYW55KSh2YWx1ZSk7XG4gICAgICB0aGlzLm9wY29kZShbJ2xpdGVyYWwnLCBrZXldLCBudWxsKTtcbiAgICB9XG5cbiAgICB0aGlzLm9wY29kZShbJ3ByZXBhcmVPYmplY3QnLCBwYWlycy5sZW5ndGhdLCBudWxsKTtcbiAgfVxuXG4gIHByZXBhcmVBdHRyaWJ1dGVWYWx1ZSh2YWx1ZTogQVNULkF0dHJOb2RlWyd2YWx1ZSddKSB7XG4gICAgLy8gcmV0dXJucyB0aGUgc3RhdGljIHZhbHVlIGlmIHRoZSB2YWx1ZSBpcyBzdGF0aWNcblxuICAgIHN3aXRjaCAodmFsdWUudHlwZSkge1xuICAgICAgY2FzZSAnVGV4dE5vZGUnOlxuICAgICAgICB0aGlzLm9wY29kZShbJ2xpdGVyYWwnLCB2YWx1ZS5jaGFyc10sIHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICBjYXNlICdNdXN0YWNoZVN0YXRlbWVudCc6XG4gICAgICAgIHRoaXMuYXR0cmlidXRlTXVzdGFjaGUoW3ZhbHVlXSk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIGNhc2UgJ0NvbmNhdFN0YXRlbWVudCc6XG4gICAgICAgIHRoaXMucHJlcGFyZUNvbmNhdFBhcnRzKHZhbHVlLnBhcnRzKTtcbiAgICAgICAgdGhpcy5vcGNvZGUoWydjb25jYXQnLCBudWxsXSwgdmFsdWUpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcHJlcGFyZUNvbmNhdFBhcnRzKHBhcnRzOiBBU1QuQ29uY2F0U3RhdGVtZW50WydwYXJ0cyddKSB7XG4gICAgZm9yIChsZXQgaSA9IHBhcnRzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBsZXQgcGFydCA9IHBhcnRzW2ldO1xuXG4gICAgICBpZiAocGFydC50eXBlID09PSAnTXVzdGFjaGVTdGF0ZW1lbnQnKSB7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlTXVzdGFjaGUoW3BhcnRdKTtcbiAgICAgIH0gZWxzZSBpZiAocGFydC50eXBlID09PSAnVGV4dE5vZGUnKSB7XG4gICAgICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIHBhcnQuY2hhcnNdLCBudWxsKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLm9wY29kZShbJ3ByZXBhcmVBcnJheScsIHBhcnRzLmxlbmd0aF0sIG51bGwpO1xuICB9XG5cbiAgYXR0cmlidXRlTXVzdGFjaGUoW2FjdGlvbl06IFtBU1QuTXVzdGFjaGVTdGF0ZW1lbnRdKSB7XG4gICAgdGhpcy5tdXN0YWNoZUV4cHJlc3Npb24oYWN0aW9uKTtcbiAgfVxuXG4gIG1ldGEobm9kZTogQVNULkJhc2VOb2RlKSB7XG4gICAgbGV0IGxvYyA9IG5vZGUubG9jO1xuICAgIGlmICghbG9jKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgbGV0IHsgc291cmNlLCBzdGFydCwgZW5kIH0gPSBsb2M7XG4gICAgcmV0dXJuIFsnbG9jJywgW3NvdXJjZSB8fCBudWxsLCBbc3RhcnQubGluZSwgc3RhcnQuY29sdW1uXSwgW2VuZC5saW5lLCBlbmQuY29sdW1uXV1dO1xuICB9XG59XG5cbmZ1bmN0aW9uIGlzSGVscGVySW52b2NhdGlvbihcbiAgbXVzdGFjaGU6IEFTVC5NdXN0YWNoZVN0YXRlbWVudFxuKTogbXVzdGFjaGUgaXMgQVNULk11c3RhY2hlU3RhdGVtZW50ICYgeyBwYXRoOiBBU1QuUGF0aEV4cHJlc3Npb24gfSB7XG4gIHJldHVybiAoXG4gICAgKG11c3RhY2hlLnBhcmFtcyAmJiBtdXN0YWNoZS5wYXJhbXMubGVuZ3RoID4gMCkgfHxcbiAgICAobXVzdGFjaGUuaGFzaCAmJiBtdXN0YWNoZS5oYXNoLnBhaXJzLmxlbmd0aCA+IDApXG4gICk7XG59XG5cbmZ1bmN0aW9uIGlzU2ltcGxlUGF0aCh7IHBhcnRzIH06IEFTVC5QYXRoRXhwcmVzc2lvbik6IGJvb2xlYW4ge1xuICByZXR1cm4gcGFydHMubGVuZ3RoID09PSAxO1xufVxuXG5mdW5jdGlvbiBpc1lpZWxkKHBhdGg6IEFTVC5QYXRoRXhwcmVzc2lvbikge1xuICByZXR1cm4gcGF0aC5vcmlnaW5hbCA9PT0gJ3lpZWxkJztcbn1cblxuZnVuY3Rpb24gaXNQYXJ0aWFsKHBhdGg6IEFTVC5QYXRoRXhwcmVzc2lvbikge1xuICByZXR1cm4gcGF0aC5vcmlnaW5hbCA9PT0gJ3BhcnRpYWwnO1xufVxuXG5mdW5jdGlvbiBpc0RlYnVnZ2VyKHBhdGg6IEFTVC5QYXRoRXhwcmVzc2lvbikge1xuICByZXR1cm4gcGF0aC5vcmlnaW5hbCA9PT0gJ2RlYnVnZ2VyJztcbn1cblxuZnVuY3Rpb24gaXNIYXNCbG9jayhwYXRoOiBBU1QuUGF0aEV4cHJlc3Npb24pIHtcbiAgcmV0dXJuIHBhdGgub3JpZ2luYWwgPT09ICdoYXMtYmxvY2snO1xufVxuXG5mdW5jdGlvbiBpc0hhc0Jsb2NrUGFyYW1zKHBhdGg6IEFTVC5QYXRoRXhwcmVzc2lvbikge1xuICByZXR1cm4gcGF0aC5vcmlnaW5hbCA9PT0gJ2hhcy1ibG9jay1wYXJhbXMnO1xufVxuXG5mdW5jdGlvbiBpc0J1aWx0SW5IZWxwZXIocGF0aDogQVNULlBhdGhFeHByZXNzaW9uKSB7XG4gIHJldHVybiBpc0hhc0Jsb2NrKHBhdGgpIHx8IGlzSGFzQmxvY2tQYXJhbXMocGF0aCk7XG59XG5cbmZ1bmN0aW9uIGlzQXJnKHBhdGg6IEFTVC5QYXRoRXhwcmVzc2lvbik6IGJvb2xlYW4ge1xuICByZXR1cm4gISFwYXRoWydkYXRhJ107XG59XG5cbmZ1bmN0aW9uIGlzRHluYW1pY0NvbXBvbmVudChlbGVtZW50OiBBU1QuRWxlbWVudE5vZGUpOiBib29sZWFuIHtcbiAgbGV0IG9wZW4gPSBlbGVtZW50LnRhZy5jaGFyQXQoMCk7XG5cbiAgbGV0IFttYXliZUxvY2FsXSA9IGVsZW1lbnQudGFnLnNwbGl0KCcuJyk7XG4gIGxldCBpc05hbWVkQXJndW1lbnQgPSBvcGVuID09PSAnQCc7XG4gIGxldCBpc0xvY2FsID0gZWxlbWVudFsnc3ltYm9scyddLmhhcyhtYXliZUxvY2FsKTtcbiAgbGV0IGlzVGhpc1BhdGggPSBlbGVtZW50LnRhZy5pbmRleE9mKCd0aGlzLicpID09PSAwO1xuXG4gIHJldHVybiBpc0xvY2FsIHx8IGlzTmFtZWRBcmd1bWVudCB8fCBpc1RoaXNQYXRoO1xufVxuXG5mdW5jdGlvbiBpc0NvbXBvbmVudChlbGVtZW50OiBBU1QuRWxlbWVudE5vZGUpOiBib29sZWFuIHtcbiAgbGV0IG9wZW4gPSBlbGVtZW50LnRhZy5jaGFyQXQoMCk7XG4gIGxldCBpc1BhdGggPSBlbGVtZW50LnRhZy5pbmRleE9mKCcuJykgPiAtMTtcblxuICBsZXQgaXNVcHBlckNhc2UgPSBvcGVuID09PSBvcGVuLnRvVXBwZXJDYXNlKCkgJiYgb3BlbiAhPT0gb3Blbi50b0xvd2VyQ2FzZSgpO1xuXG4gIHJldHVybiAoaXNVcHBlckNhc2UgJiYgIWlzUGF0aCkgfHwgaXNEeW5hbWljQ29tcG9uZW50KGVsZW1lbnQpO1xufVxuXG5mdW5jdGlvbiBhc3NlcnRJc1NpbXBsZVBhdGgocGF0aDogQVNULlBhdGhFeHByZXNzaW9uLCBsb2M6IEFTVC5Tb3VyY2VMb2NhdGlvbiwgY29udGV4dDogc3RyaW5nKSB7XG4gIGlmICghaXNTaW1wbGVQYXRoKHBhdGgpKSB7XG4gICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKFxuICAgICAgYFxcYCR7cGF0aC5vcmlnaW5hbH1cXGAgaXMgbm90IGEgdmFsaWQgbmFtZSBmb3IgYSAke2NvbnRleHR9IG9uIGxpbmUgJHtsb2Muc3RhcnQubGluZX0uYCxcbiAgICAgIHBhdGgubG9jXG4gICAgKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBhc3NlcnRWYWxpZFlpZWxkKHN0YXRlbWVudDogQVNULk11c3RhY2hlU3RhdGVtZW50KTogc3RyaW5nIHtcbiAgbGV0IHsgcGFpcnMgfSA9IHN0YXRlbWVudC5oYXNoO1xuXG4gIGlmICgocGFpcnMubGVuZ3RoID09PSAxICYmIHBhaXJzWzBdLmtleSAhPT0gJ3RvJykgfHwgcGFpcnMubGVuZ3RoID4gMSkge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihgeWllbGQgb25seSB0YWtlcyBhIHNpbmdsZSBuYW1lZCBhcmd1bWVudDogJ3RvJ2AsIHN0YXRlbWVudC5sb2MpO1xuICB9IGVsc2UgaWYgKHBhaXJzLmxlbmd0aCA9PT0gMSAmJiBwYWlyc1swXS52YWx1ZS50eXBlICE9PSAnU3RyaW5nTGl0ZXJhbCcpIHtcbiAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoYHlvdSBjYW4gb25seSB5aWVsZCB0byBhIGxpdGVyYWwgdmFsdWVgLCBzdGF0ZW1lbnQubG9jKTtcbiAgfSBlbHNlIGlmIChwYWlycy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gJ2RlZmF1bHQnO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiAocGFpcnNbMF0udmFsdWUgYXMgQVNULlN0cmluZ0xpdGVyYWwpLnZhbHVlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGFzc2VydFZhbGlkUGFydGlhbChzdGF0ZW1lbnQ6IEFTVC5NdXN0YWNoZVN0YXRlbWVudCkgLyogOiBleHByICovIHtcbiAgbGV0IHsgcGFyYW1zLCBoYXNoLCBlc2NhcGVkLCBsb2MgfSA9IHN0YXRlbWVudDtcblxuICBpZiAocGFyYW1zICYmIHBhcmFtcy5sZW5ndGggIT09IDEpIHtcbiAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoXG4gICAgICBgUGFydGlhbCBmb3VuZCB3aXRoIG5vIGFyZ3VtZW50cy4gWW91IG11c3Qgc3BlY2lmeSBhIHRlbXBsYXRlIG5hbWUuIChvbiBsaW5lICR7XG4gICAgICAgIGxvYy5zdGFydC5saW5lXG4gICAgICB9KWAsXG4gICAgICBzdGF0ZW1lbnQubG9jXG4gICAgKTtcbiAgfSBlbHNlIGlmIChoYXNoICYmIGhhc2gucGFpcnMubGVuZ3RoID4gMCkge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihcbiAgICAgIGBwYXJ0aWFsIGRvZXMgbm90IHRha2UgYW55IG5hbWVkIGFyZ3VtZW50cyAob24gbGluZSAke2xvYy5zdGFydC5saW5lfSlgLFxuICAgICAgc3RhdGVtZW50LmxvY1xuICAgICk7XG4gIH0gZWxzZSBpZiAoIWVzY2FwZWQpIHtcbiAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoXG4gICAgICBge3t7cGFydGlhbCAuLi59fX0gaXMgbm90IHN1cHBvcnRlZCwgcGxlYXNlIHVzZSB7e3BhcnRpYWwgLi4ufX0gaW5zdGVhZCAob24gbGluZSAke1xuICAgICAgICBsb2Muc3RhcnQubGluZVxuICAgICAgfSlgLFxuICAgICAgc3RhdGVtZW50LmxvY1xuICAgICk7XG4gIH1cblxuICByZXR1cm4gcGFyYW1zO1xufVxuXG5mdW5jdGlvbiBhc3NlcnRWYWxpZEhhc0Jsb2NrVXNhZ2UodHlwZTogc3RyaW5nLCBjYWxsOiBBU1QuQ2FsbCk6IHN0cmluZyB7XG4gIGxldCB7IHBhcmFtcywgaGFzaCwgbG9jIH0gPSBjYWxsO1xuXG4gIGlmIChoYXNoICYmIGhhc2gucGFpcnMubGVuZ3RoID4gMCkge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihgJHt0eXBlfSBkb2VzIG5vdCB0YWtlIGFueSBuYW1lZCBhcmd1bWVudHNgLCBjYWxsLmxvYyk7XG4gIH1cblxuICBpZiAocGFyYW1zLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiAnZGVmYXVsdCc7XG4gIH0gZWxzZSBpZiAocGFyYW1zLmxlbmd0aCA9PT0gMSkge1xuICAgIGxldCBwYXJhbSA9IHBhcmFtc1swXTtcbiAgICBpZiAocGFyYW0udHlwZSA9PT0gJ1N0cmluZ0xpdGVyYWwnKSB7XG4gICAgICByZXR1cm4gcGFyYW0udmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihcbiAgICAgICAgYHlvdSBjYW4gb25seSB5aWVsZCB0byBhIGxpdGVyYWwgdmFsdWUgKG9uIGxpbmUgJHtsb2Muc3RhcnQubGluZX0pYCxcbiAgICAgICAgY2FsbC5sb2NcbiAgICAgICk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihcbiAgICAgIGAke3R5cGV9IG9ubHkgdGFrZXMgYSBzaW5nbGUgcG9zaXRpb25hbCBhcmd1bWVudCAob24gbGluZSAke2xvYy5zdGFydC5saW5lfSlgLFxuICAgICAgY2FsbC5sb2NcbiAgICApO1xuICB9XG59XG5cbmZ1bmN0aW9uIGFzc2VydFZhbGlkRGVidWdnZXJVc2FnZShzdGF0ZW1lbnQ6IEFTVC5NdXN0YWNoZVN0YXRlbWVudCkge1xuICBsZXQgeyBwYXJhbXMsIGhhc2ggfSA9IHN0YXRlbWVudDtcblxuICBpZiAoaGFzaCAmJiBoYXNoLnBhaXJzLmxlbmd0aCA+IDApIHtcbiAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoYGRlYnVnZ2VyIGRvZXMgbm90IHRha2UgYW55IG5hbWVkIGFyZ3VtZW50c2AsIHN0YXRlbWVudC5sb2MpO1xuICB9XG5cbiAgaWYgKHBhcmFtcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gJ2RlZmF1bHQnO1xuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihgZGVidWdnZXIgZG9lcyBub3QgdGFrZSBhbnkgcG9zaXRpb25hbCBhcmd1bWVudHNgLCBzdGF0ZW1lbnQubG9jKTtcbiAgfVxufVxuIl19