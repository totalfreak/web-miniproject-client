import TemplateVisitor from './template-visitor';
import JavaScriptCompiler from './javascript-compiler';
import { assert } from '@glimmer/util';
import { isLiteral, SyntaxError } from '@glimmer/syntax';
import { getAttrNamespace } from './utils';
import { SymbolAllocator } from './allocate-symbols';
function isTrustedValue(value) {
    return value.escaped !== undefined && !value.escaped;
}
export const THIS = 0;
export default class TemplateCompiler {
    constructor() {
        this.templateId = 0;
        this.templateIds = [];
        this.opcodes = [];
        this.includeMeta = false;
    }
    static compile(ast, options) {
        let templateVisitor = new TemplateVisitor();
        templateVisitor.visit(ast);
        let compiler = new TemplateCompiler();
        let opcodes = compiler.process(templateVisitor.actions);
        let symbols = new SymbolAllocator(opcodes).process();
        return JavaScriptCompiler.process(symbols, ast['symbols'], options);
    }
    process(actions) {
        actions.forEach(([name, ...args]) => {
            if (!this[name]) {
                throw new Error(`Unimplemented ${name} on TemplateCompiler`);
            }
            this[name](...args);
        });
        return this.opcodes;
    }
    startProgram([program]) {
        this.opcode(['startProgram', program], program);
    }
    endProgram() {
        this.opcode(['endProgram', null], null);
    }
    startBlock([program]) {
        this.templateId++;
        this.opcode(['startBlock', program], program);
    }
    endBlock() {
        this.templateIds.push(this.templateId - 1);
        this.opcode(['endBlock', null], null);
    }
    text([action]) {
        this.opcode(['text', action.chars], action);
    }
    comment([action]) {
        this.opcode(['comment', action.value], action);
    }
    openElement([action]) {
        let attributes = action.attributes;
        let hasSplat = false;
        for (let i = 0; i < attributes.length; i++) {
            let attr = attributes[i];
            if (attr.name === '...attributes') {
                hasSplat = true;
                break;
            }
        }
        let actionIsComponent = false;
        if (isDynamicComponent(action)) {
            let head, rest;
            [head, ...rest] = action.tag.split('.');
            if (head === 'this') {
                head = 0;
            }
            this.opcode(['get', [head, rest]]);
            this.opcode(['openComponent', action], action);
            actionIsComponent = true;
        } else if (isComponent(action)) {
            this.opcode(['openComponent', action], action);
            actionIsComponent = true;
        } else if (hasSplat) {
            this.opcode(['openSplattedElement', action], action);
        } else {
            this.opcode(['openElement', action], action);
        }
        let typeAttr = null;
        let attrs = action.attributes;
        for (let i = 0; i < attrs.length; i++) {
            if (attrs[i].name === 'type') {
                typeAttr = attrs[i];
                continue;
            }
            this.attribute([attrs[i]], hasSplat || actionIsComponent);
        }
        if (typeAttr) {
            this.attribute([typeAttr], hasSplat || actionIsComponent);
        }
        this.opcode(['flushElement', action], null);
    }
    closeElement([action]) {
        if (isDynamicComponent(action)) {
            this.opcode(['closeDynamicComponent', action], action);
        } else if (isComponent(action)) {
            this.opcode(['closeComponent', action], action);
        } else if (action.modifiers.length > 0) {
            for (let i = 0; i < action.modifiers.length; i++) {
                this.modifier([action.modifiers[i]]);
            }
            this.opcode(['closeElement', action], action);
        } else {
            this.opcode(['closeElement', action], action);
        }
    }
    attribute([action], isComponent) {
        let { name, value } = action;
        let namespace = getAttrNamespace(name);
        let isStatic = this.prepareAttributeValue(value);
        if (name.charAt(0) === '@') {
            // Arguments
            if (isStatic) {
                this.opcode(['staticArg', name], action);
            } else if (action.value.type === 'MustacheStatement') {
                this.opcode(['dynamicArg', name], action);
            } else {
                this.opcode(['dynamicArg', name], action);
            }
        } else {
            let isTrusting = isTrustedValue(value);
            if (isStatic && name === '...attributes') {
                this.opcode(['attrSplat', null], action);
            } else if (isStatic && !isComponent) {
                this.opcode(['staticAttr', [name, namespace]], action);
            } else if (isTrusting) {
                this.opcode([isComponent ? 'trustingComponentAttr' : 'trustingAttr', [name, namespace]], action);
            } else if (action.value.type === 'MustacheStatement') {
                this.opcode([isComponent ? 'componentAttr' : 'dynamicAttr', [name, null]], action);
            } else {
                this.opcode([isComponent ? 'componentAttr' : 'dynamicAttr', [name, namespace]], action);
            }
        }
    }
    modifier([action]) {
        assertIsSimplePath(action.path, action.loc, 'modifier');
        let { path: { parts } } = action;
        this.prepareHelper(action);
        this.opcode(['modifier', parts[0]], action);
    }
    mustache([action]) {
        let { path } = action;
        if (isLiteral(path)) {
            this.mustacheExpression(action);
            this.opcode(['append', !action.escaped], action);
        } else if (isYield(path)) {
            let to = assertValidYield(action);
            this.yield(to, action);
        } else if (isPartial(path)) {
            let params = assertValidPartial(action);
            this.partial(params, action);
        } else if (isDebugger(path)) {
            assertValidDebuggerUsage(action);
            this.debugger('debugger', action);
        } else {
            this.mustacheExpression(action);
            this.opcode(['append', !action.escaped], action);
        }
    }
    block([action /*, index, count*/]) {
        this.prepareHelper(action);
        let templateId = this.templateIds.pop();
        let inverseId = action.inverse === null ? null : this.templateIds.pop();
        this.opcode(['block', [action.path.parts[0], templateId, inverseId]], action);
    }
    /// Internal actions, not found in the original processed actions
    arg([path]) {
        let { parts: [head, ...rest] } = path;
        this.opcode(['get', [`@${head}`, rest]], path);
    }
    mustacheExpression(expr) {
        let { path } = expr;
        if (isLiteral(path)) {
            this.opcode(['literal', path.value], expr);
        } else if (isBuiltInHelper(path)) {
            this.builtInHelper(expr);
        } else if (isArg(path)) {
            this.arg([path]);
        } else if (isHelperInvocation(expr)) {
            this.prepareHelper(expr);
            this.opcode(['helper', path.parts[0]], expr);
        } else if (path.this) {
            this.opcode(['get', [0, path.parts]], expr);
        } else {
            let [head, ...parts] = path.parts;
            this.opcode(['maybeGet', [head, parts]], expr);
        }
        // } else if (isLocal(path, this.symbols)) {
        //   let [head, ...parts] = path.parts;
        //   this.opcode(['get', [head, parts]], expr);
        // } else if (isSimplePath(path)) {
        //   this.opcode(['unknown', path.parts[0]], expr);
        // } else {
        //   this.opcode(['maybeLocal', path.parts], expr);
        // }
    }
    /// Internal Syntax
    yield(to, action) {
        this.prepareParams(action.params);
        this.opcode(['yield', to], action);
    }
    debugger(_name, action) {
        this.opcode(['debugger', null], action);
    }
    hasBlock(name, action) {
        this.opcode(['hasBlock', name], action);
    }
    hasBlockParams(name, action) {
        this.opcode(['hasBlockParams', name], action);
    }
    partial(_params, action) {
        this.prepareParams(action.params);
        this.opcode(['partial', null], action);
    }
    builtInHelper(expr) {
        let { path } = expr;
        if (isHasBlock(path)) {
            let name = assertValidHasBlockUsage(expr.path.original, expr);
            this.hasBlock(name, expr);
        } else if (isHasBlockParams(path)) {
            let name = assertValidHasBlockUsage(expr.path.original, expr);
            this.hasBlockParams(name, expr);
        }
    }
    /// Expressions, invoked recursively from prepareParams and prepareHash
    SubExpression(expr) {
        if (isBuiltInHelper(expr.path)) {
            this.builtInHelper(expr);
        } else {
            this.prepareHelper(expr);
            this.opcode(['helper', expr.path.parts[0]], expr);
        }
    }
    PathExpression(expr) {
        if (expr.data) {
            this.arg([expr]);
        } else {
            let [head, ...rest] = expr.parts;
            if (expr.this) {
                this.opcode(['get', [0, expr.parts]], expr);
            } else {
                this.opcode(['get', [head, rest]], expr);
            }
        }
    }
    StringLiteral(action) {
        this.opcode(['literal', action.value], action);
    }
    BooleanLiteral(action) {
        this.opcode(['literal', action.value], action);
    }
    NumberLiteral(action) {
        this.opcode(['literal', action.value], action);
    }
    NullLiteral(action) {
        this.opcode(['literal', action.value], action);
    }
    UndefinedLiteral(action) {
        this.opcode(['literal', action.value], action);
    }
    /// Utilities
    opcode(opcode, action = null) {
        // TODO: This doesn't really work
        if (this.includeMeta && action) {
            opcode.push(this.meta(action));
        }
        this.opcodes.push(opcode);
    }
    prepareHelper(expr) {
        assertIsSimplePath(expr.path, expr.loc, 'helper');
        let { params, hash } = expr;
        this.prepareHash(hash);
        this.prepareParams(params);
    }
    prepareParams(params) {
        if (!params.length) {
            this.opcode(['literal', null], null);
            return;
        }
        for (let i = params.length - 1; i >= 0; i--) {
            let param = params[i];
            (false && assert(this[param.type], `Unimplemented ${param.type} on TemplateCompiler`));

            this[param.type](param);
        }
        this.opcode(['prepareArray', params.length], null);
    }
    prepareHash(hash) {
        let pairs = hash.pairs;
        if (!pairs.length) {
            this.opcode(['literal', null], null);
            return;
        }
        for (let i = pairs.length - 1; i >= 0; i--) {
            let { key, value } = pairs[i];
            (false && assert(this[value.type], `Unimplemented ${value.type} on TemplateCompiler`));

            this[value.type](value);
            this.opcode(['literal', key], null);
        }
        this.opcode(['prepareObject', pairs.length], null);
    }
    prepareAttributeValue(value) {
        // returns the static value if the value is static
        switch (value.type) {
            case 'TextNode':
                this.opcode(['literal', value.chars], value);
                return true;
            case 'MustacheStatement':
                this.attributeMustache([value]);
                return false;
            case 'ConcatStatement':
                this.prepareConcatParts(value.parts);
                this.opcode(['concat', null], value);
                return false;
        }
    }
    prepareConcatParts(parts) {
        for (let i = parts.length - 1; i >= 0; i--) {
            let part = parts[i];
            if (part.type === 'MustacheStatement') {
                this.attributeMustache([part]);
            } else if (part.type === 'TextNode') {
                this.opcode(['literal', part.chars], null);
            }
        }
        this.opcode(['prepareArray', parts.length], null);
    }
    attributeMustache([action]) {
        this.mustacheExpression(action);
    }
    meta(node) {
        let loc = node.loc;
        if (!loc) {
            return [];
        }
        let { source, start, end } = loc;
        return ['loc', [source || null, [start.line, start.column], [end.line, end.column]]];
    }
}
function isHelperInvocation(mustache) {
    return mustache.params && mustache.params.length > 0 || mustache.hash && mustache.hash.pairs.length > 0;
}
function isSimplePath({ parts }) {
    return parts.length === 1;
}
function isYield(path) {
    return path.original === 'yield';
}
function isPartial(path) {
    return path.original === 'partial';
}
function isDebugger(path) {
    return path.original === 'debugger';
}
function isHasBlock(path) {
    return path.original === 'has-block';
}
function isHasBlockParams(path) {
    return path.original === 'has-block-params';
}
function isBuiltInHelper(path) {
    return isHasBlock(path) || isHasBlockParams(path);
}
function isArg(path) {
    return !!path['data'];
}
function isDynamicComponent(element) {
    let open = element.tag.charAt(0);
    let [maybeLocal] = element.tag.split('.');
    let isNamedArgument = open === '@';
    let isLocal = element['symbols'].has(maybeLocal);
    let isThisPath = element.tag.indexOf('this.') === 0;
    return isLocal || isNamedArgument || isThisPath;
}
function isComponent(element) {
    let open = element.tag.charAt(0);
    let isPath = element.tag.indexOf('.') > -1;
    let isUpperCase = open === open.toUpperCase() && open !== open.toLowerCase();
    return isUpperCase && !isPath || isDynamicComponent(element);
}
function assertIsSimplePath(path, loc, context) {
    if (!isSimplePath(path)) {
        throw new SyntaxError(`\`${path.original}\` is not a valid name for a ${context} on line ${loc.start.line}.`, path.loc);
    }
}
function assertValidYield(statement) {
    let { pairs } = statement.hash;
    if (pairs.length === 1 && pairs[0].key !== 'to' || pairs.length > 1) {
        throw new SyntaxError(`yield only takes a single named argument: 'to'`, statement.loc);
    } else if (pairs.length === 1 && pairs[0].value.type !== 'StringLiteral') {
        throw new SyntaxError(`you can only yield to a literal value`, statement.loc);
    } else if (pairs.length === 0) {
        return 'default';
    } else {
        return pairs[0].value.value;
    }
}
function assertValidPartial(statement) {
    let { params, hash, escaped, loc } = statement;
    if (params && params.length !== 1) {
        throw new SyntaxError(`Partial found with no arguments. You must specify a template name. (on line ${loc.start.line})`, statement.loc);
    } else if (hash && hash.pairs.length > 0) {
        throw new SyntaxError(`partial does not take any named arguments (on line ${loc.start.line})`, statement.loc);
    } else if (!escaped) {
        throw new SyntaxError(`{{{partial ...}}} is not supported, please use {{partial ...}} instead (on line ${loc.start.line})`, statement.loc);
    }
    return params;
}
function assertValidHasBlockUsage(type, call) {
    let { params, hash, loc } = call;
    if (hash && hash.pairs.length > 0) {
        throw new SyntaxError(`${type} does not take any named arguments`, call.loc);
    }
    if (params.length === 0) {
        return 'default';
    } else if (params.length === 1) {
        let param = params[0];
        if (param.type === 'StringLiteral') {
            return param.value;
        } else {
            throw new SyntaxError(`you can only yield to a literal value (on line ${loc.start.line})`, call.loc);
        }
    } else {
        throw new SyntaxError(`${type} only takes a single positional argument (on line ${loc.start.line})`, call.loc);
    }
}
function assertValidDebuggerUsage(statement) {
    let { params, hash } = statement;
    if (hash && hash.pairs.length > 0) {
        throw new SyntaxError(`debugger does not take any named arguments`, statement.loc);
    }
    if (params.length === 0) {
        return 'default';
    } else {
        throw new SyntaxError(`debugger does not take any positional arguments`, statement.loc);
    }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVtcGxhdGUtY29tcGlsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9jb21waWxlci9saWIvdGVtcGxhdGUtY29tcGlsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxBQUEyQixxQkFBTSxBQUFvQixBQUFDO0FBQzdELE9BQU8sQUFBZ0Msd0JBQU0sQUFBdUIsQUFBQztBQUNyRSxBQUFPLFNBQUUsQUFBTSxBQUFVLGNBQU0sQUFBZSxBQUFDO0FBQy9DLEFBQU8sU0FBTyxBQUFTLFdBQUUsQUFBVyxBQUFFLG1CQUFNLEFBQWlCLEFBQUM7QUFDOUQsQUFBTyxTQUFFLEFBQWdCLEFBQUUsd0JBQU0sQUFBUyxBQUFDO0FBRTNDLEFBQU8sU0FBRSxBQUFlLEFBQTRDLHVCQUFNLEFBQW9CLEFBQUM7QUFRL0YsU0FBUyxBQUFjLGVBQUMsQUFBVTtBQUNoQyxXQUFPLEFBQUssTUFBQyxBQUFPLFlBQUssQUFBUyxhQUFJLENBQUMsQUFBSyxNQUFDLEFBQU8sQUFBQyxBQUN2RDtBQUFDO0FBRUQsQUFBTSxPQUFDLE1BQU0sQUFBSSxPQUFHLEFBQUMsQUFBQztBQUV0QixBQUFNLEFBQUMsQUFBTyxxQkFBTyxBQUFnQjtBQUFyQztBQVlVLGFBQVUsYUFBRyxBQUFDLEFBQUM7QUFDZixhQUFXLGNBQWEsQUFBRSxBQUFDO0FBQzNCLGFBQU8sVUFBaUIsQUFBRSxBQUFDO0FBQzNCLGFBQVcsY0FBRyxBQUFLLEFBQUMsQUF5WTlCO0FBQUM7QUF2WkMsQUFBTSxXQUFDLEFBQU8sUUFBQyxBQUFnQixLQUFFLEFBQXdCO0FBQ3ZELFlBQUksQUFBZSxrQkFBRyxJQUFJLEFBQWUsQUFBRSxBQUFDO0FBQzVDLEFBQWUsd0JBQUMsQUFBSyxNQUFDLEFBQUcsQUFBQyxBQUFDO0FBRTNCLFlBQUksQUFBUSxXQUFHLElBQUksQUFBZ0IsQUFBRSxBQUFDO0FBQ3RDLFlBQUksQUFBTyxVQUFpQixBQUFR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dkIsZUFBTyxBQUFTLEFBQUM7QUFDbEIsV0FBTTtBQUNMLGNBQU0sSUFBSSxBQUFXLEFBQUMsWUFBaUQsbURBQUUsQUFBUyxVQUFDLEFBQUcsQUFBQyxBQUFDO0FBQ3pGLEFBQ0g7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBUZW1wbGF0ZVZpc2l0b3IsIHsgQWN0aW9uIH0gZnJvbSAnLi90ZW1wbGF0ZS12aXNpdG9yJztcbmltcG9ydCBKYXZhU2NyaXB0Q29tcGlsZXIsIHsgVGVtcGxhdGUgfSBmcm9tICcuL2phdmFzY3JpcHQtY29tcGlsZXInO1xuaW1wb3J0IHsgYXNzZXJ0LCBPcHRpb24gfSBmcm9tICdAZ2xpbW1lci91dGlsJztcbmltcG9ydCB7IEFTVCwgaXNMaXRlcmFsLCBTeW50YXhFcnJvciB9IGZyb20gJ0BnbGltbWVyL3N5bnRheCc7XG5pbXBvcnQgeyBnZXRBdHRyTmFtZXNwYWNlIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBPcGFxdWUgfSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcbmltcG9ydCB7IFN5bWJvbEFsbG9jYXRvciwgSW5PcCBhcyBTeW1ib2xJbk9wLCBPdXRPcCBhcyBTeW1ib2xPdXRPcCB9IGZyb20gJy4vYWxsb2NhdGUtc3ltYm9scyc7XG5pbXBvcnQgeyBQYXRoSGVhZCB9IGZyb20gJy4vY29tcGlsZXItb3BzJztcblxuZXhwb3J0IGludGVyZmFjZSBDb21waWxlT3B0aW9ucyB7XG4gIG1ldGE6IE9wYXF1ZTtcbiAgY3VzdG9taXplQ29tcG9uZW50TmFtZT8odGFnOiBzdHJpbmcpOiBzdHJpbmc7XG59XG5cbmZ1bmN0aW9uIGlzVHJ1c3RlZFZhbHVlKHZhbHVlOiBhbnkpIHtcbiAgcmV0dXJuIHZhbHVlLmVzY2FwZWQgIT09IHVuZGVmaW5lZCAmJiAhdmFsdWUuZXNjYXBlZDtcbn1cblxuZXhwb3J0IGNvbnN0IFRISVMgPSAwO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUZW1wbGF0ZUNvbXBpbGVyIHtcbiAgc3RhdGljIGNvbXBpbGUoYXN0OiBBU1QuUHJvZ3JhbSwgb3B0aW9ucz86IENvbXBpbGVPcHRpb25zKTogVGVtcGxhdGUge1xuICAgIGxldCB0ZW1wbGF0ZVZpc2l0b3IgPSBuZXcgVGVtcGxhdGVWaXNpdG9yKCk7XG4gICAgdGVtcGxhdGVWaXNpdG9yLnZpc2l0KGFzdCk7XG5cbiAgICBsZXQgY29tcGlsZXIgPSBuZXcgVGVtcGxhdGVDb21waWxlcigpO1xuICAgIGxldCBvcGNvZGVzOiBTeW1ib2xJbk9wW10gPSBjb21waWxlci5wcm9jZXNzKHRlbXBsYXRlVmlzaXRvci5hY3Rpb25zKTtcbiAgICBsZXQgc3ltYm9sczogU3ltYm9sT3V0T3BbXSA9IG5ldyBTeW1ib2xBbGxvY2F0b3Iob3Bjb2RlcykucHJvY2VzcygpO1xuXG4gICAgcmV0dXJuIEphdmFTY3JpcHRDb21waWxlci5wcm9jZXNzKHN5bWJvbHMsIGFzdFsnc3ltYm9scyddLCBvcHRpb25zKTtcbiAgfVxuXG4gIHByaXZhdGUgdGVtcGxhdGVJZCA9IDA7XG4gIHByaXZhdGUgdGVtcGxhdGVJZHM6IG51bWJlcltdID0gW107XG4gIHByaXZhdGUgb3Bjb2RlczogU3ltYm9sSW5PcFtdID0gW107XG4gIHByaXZhdGUgaW5jbHVkZU1ldGEgPSBmYWxzZTtcblxuICBwcm9jZXNzKGFjdGlvbnM6IEFjdGlvbltdKTogU3ltYm9sSW5PcFtdIHtcbiAgICBhY3Rpb25zLmZvckVhY2goKFtuYW1lLCAuLi5hcmdzXSkgPT4ge1xuICAgICAgaWYgKCF0aGlzW25hbWVdKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5pbXBsZW1lbnRlZCAke25hbWV9IG9uIFRlbXBsYXRlQ29tcGlsZXJgKTtcbiAgICAgIH1cbiAgICAgICh0aGlzW25hbWVdIGFzIGFueSkoLi4uYXJncyk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMub3Bjb2RlcztcbiAgfVxuXG4gIHN0YXJ0UHJvZ3JhbShbcHJvZ3JhbV06IFtBU1QuUHJvZ3JhbV0pIHtcbiAgICB0aGlzLm9wY29kZShbJ3N0YXJ0UHJvZ3JhbScsIHByb2dyYW1dLCBwcm9ncmFtKTtcbiAgfVxuXG4gIGVuZFByb2dyYW0oKSB7XG4gICAgdGhpcy5vcGNvZGUoWydlbmRQcm9ncmFtJywgbnVsbF0sIG51bGwpO1xuICB9XG5cbiAgc3RhcnRCbG9jayhbcHJvZ3JhbV06IFtBU1QuUHJvZ3JhbV0pIHtcbiAgICB0aGlzLnRlbXBsYXRlSWQrKztcbiAgICB0aGlzLm9wY29kZShbJ3N0YXJ0QmxvY2snLCBwcm9ncmFtXSwgcHJvZ3JhbSk7XG4gIH1cblxuICBlbmRCbG9jaygpIHtcbiAgICB0aGlzLnRlbXBsYXRlSWRzLnB1c2godGhpcy50ZW1wbGF0ZUlkIC0gMSk7XG4gICAgdGhpcy5vcGNvZGUoWydlbmRCbG9jaycsIG51bGxdLCBudWxsKTtcbiAgfVxuXG4gIHRleHQoW2FjdGlvbl06IFtBU1QuVGV4dE5vZGVdKSB7XG4gICAgdGhpcy5vcGNvZGUoWyd0ZXh0JywgYWN0aW9uLmNoYXJzXSwgYWN0aW9uKTtcbiAgfVxuXG4gIGNvbW1lbnQoW2FjdGlvbl06IFtBU1QuQ29tbWVudFN0YXRlbWVudF0pIHtcbiAgICB0aGlzLm9wY29kZShbJ2NvbW1lbnQnLCBhY3Rpb24udmFsdWVdLCBhY3Rpb24pO1xuICB9XG5cbiAgb3BlbkVsZW1lbnQoW2FjdGlvbl06IFtBU1QuRWxlbWVudE5vZGVdKSB7XG4gICAgbGV0IGF0dHJpYnV0ZXMgPSBhY3Rpb24uYXR0cmlidXRlcztcbiAgICBsZXQgaGFzU3BsYXQgPSBmYWxzZTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXR0cmlidXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGF0dHIgPSBhdHRyaWJ1dGVzW2ldO1xuICAgICAgaWYgKGF0dHIubmFtZSA9PT0gJy4uLmF0dHJpYnV0ZXMnKSB7XG4gICAgICAgIGhhc1NwbGF0ID0gdHJ1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbGV0IGFjdGlvbklzQ29tcG9uZW50ID0gZmFsc2U7XG5cbiAgICBpZiAoaXNEeW5hbWljQ29tcG9uZW50KGFjdGlvbikpIHtcbiAgICAgIGxldCBoZWFkOiBQYXRoSGVhZCwgcmVzdDogc3RyaW5nW107XG4gICAgICBbaGVhZCwgLi4ucmVzdF0gPSBhY3Rpb24udGFnLnNwbGl0KCcuJyk7XG4gICAgICBpZiAoaGVhZCA9PT0gJ3RoaXMnKSB7XG4gICAgICAgIGhlYWQgPSAwO1xuICAgICAgfVxuICAgICAgdGhpcy5vcGNvZGUoWydnZXQnLCBbaGVhZCwgcmVzdF1dKTtcbiAgICAgIHRoaXMub3Bjb2RlKFsnb3BlbkNvbXBvbmVudCcsIGFjdGlvbl0sIGFjdGlvbik7XG4gICAgICBhY3Rpb25Jc0NvbXBvbmVudCA9IHRydWU7XG4gICAgfSBlbHNlIGlmIChpc0NvbXBvbmVudChhY3Rpb24pKSB7XG4gICAgICB0aGlzLm9wY29kZShbJ29wZW5Db21wb25lbnQnLCBhY3Rpb25dLCBhY3Rpb24pO1xuICAgICAgYWN0aW9uSXNDb21wb25lbnQgPSB0cnVlO1xuICAgIH0gZWxzZSBpZiAoaGFzU3BsYXQpIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnb3BlblNwbGF0dGVkRWxlbWVudCcsIGFjdGlvbl0sIGFjdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnb3BlbkVsZW1lbnQnLCBhY3Rpb25dLCBhY3Rpb24pO1xuICAgIH1cblxuICAgIGxldCB0eXBlQXR0cjogT3B0aW9uPEFTVC5BdHRyTm9kZT4gPSBudWxsO1xuICAgIGxldCBhdHRycyA9IGFjdGlvbi5hdHRyaWJ1dGVzO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXR0cnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChhdHRyc1tpXS5uYW1lID09PSAndHlwZScpIHtcbiAgICAgICAgdHlwZUF0dHIgPSBhdHRyc1tpXTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICB0aGlzLmF0dHJpYnV0ZShbYXR0cnNbaV1dLCBoYXNTcGxhdCB8fCBhY3Rpb25Jc0NvbXBvbmVudCk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVBdHRyKSB7XG4gICAgICB0aGlzLmF0dHJpYnV0ZShbdHlwZUF0dHJdLCBoYXNTcGxhdCB8fCBhY3Rpb25Jc0NvbXBvbmVudCk7XG4gICAgfVxuXG4gICAgdGhpcy5vcGNvZGUoWydmbHVzaEVsZW1lbnQnLCBhY3Rpb25dLCBudWxsKTtcbiAgfVxuXG4gIGNsb3NlRWxlbWVudChbYWN0aW9uXTogW0FTVC5FbGVtZW50Tm9kZV0pIHtcbiAgICBpZiAoaXNEeW5hbWljQ29tcG9uZW50KGFjdGlvbikpIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnY2xvc2VEeW5hbWljQ29tcG9uZW50JywgYWN0aW9uXSwgYWN0aW9uKTtcbiAgICB9IGVsc2UgaWYgKGlzQ29tcG9uZW50KGFjdGlvbikpIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnY2xvc2VDb21wb25lbnQnLCBhY3Rpb25dLCBhY3Rpb24pO1xuICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1vZGlmaWVycy5sZW5ndGggPiAwKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFjdGlvbi5tb2RpZmllcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcy5tb2RpZmllcihbYWN0aW9uLm1vZGlmaWVyc1tpXV0pO1xuICAgICAgfVxuICAgICAgdGhpcy5vcGNvZGUoWydjbG9zZUVsZW1lbnQnLCBhY3Rpb25dLCBhY3Rpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm9wY29kZShbJ2Nsb3NlRWxlbWVudCcsIGFjdGlvbl0sIGFjdGlvbik7XG4gICAgfVxuICB9XG5cbiAgYXR0cmlidXRlKFthY3Rpb25dOiBbQVNULkF0dHJOb2RlXSwgaXNDb21wb25lbnQ6IGJvb2xlYW4pIHtcbiAgICBsZXQgeyBuYW1lLCB2YWx1ZSB9ID0gYWN0aW9uO1xuXG4gICAgbGV0IG5hbWVzcGFjZSA9IGdldEF0dHJOYW1lc3BhY2UobmFtZSk7XG4gICAgbGV0IGlzU3RhdGljID0gdGhpcy5wcmVwYXJlQXR0cmlidXRlVmFsdWUodmFsdWUpO1xuXG4gICAgaWYgKG5hbWUuY2hhckF0KDApID09PSAnQCcpIHtcbiAgICAgIC8vIEFyZ3VtZW50c1xuICAgICAgaWYgKGlzU3RhdGljKSB7XG4gICAgICAgIHRoaXMub3Bjb2RlKFsnc3RhdGljQXJnJywgbmFtZV0sIGFjdGlvbik7XG4gICAgICB9IGVsc2UgaWYgKGFjdGlvbi52YWx1ZS50eXBlID09PSAnTXVzdGFjaGVTdGF0ZW1lbnQnKSB7XG4gICAgICAgIHRoaXMub3Bjb2RlKFsnZHluYW1pY0FyZycsIG5hbWVdLCBhY3Rpb24pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoWydkeW5hbWljQXJnJywgbmFtZV0sIGFjdGlvbik7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBpc1RydXN0aW5nID0gaXNUcnVzdGVkVmFsdWUodmFsdWUpO1xuXG4gICAgICBpZiAoaXNTdGF0aWMgJiYgbmFtZSA9PT0gJy4uLmF0dHJpYnV0ZXMnKSB7XG4gICAgICAgIHRoaXMub3Bjb2RlKFsnYXR0clNwbGF0JywgbnVsbF0sIGFjdGlvbik7XG4gICAgICB9IGVsc2UgaWYgKGlzU3RhdGljICYmICFpc0NvbXBvbmVudCkge1xuICAgICAgICB0aGlzLm9wY29kZShbJ3N0YXRpY0F0dHInLCBbbmFtZSwgbmFtZXNwYWNlXV0sIGFjdGlvbik7XG4gICAgICB9IGVsc2UgaWYgKGlzVHJ1c3RpbmcpIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoXG4gICAgICAgICAgW2lzQ29tcG9uZW50ID8gJ3RydXN0aW5nQ29tcG9uZW50QXR0cicgOiAndHJ1c3RpbmdBdHRyJywgW25hbWUsIG5hbWVzcGFjZV1dLFxuICAgICAgICAgIGFjdGlvblxuICAgICAgICApO1xuICAgICAgfSBlbHNlIGlmIChhY3Rpb24udmFsdWUudHlwZSA9PT0gJ011c3RhY2hlU3RhdGVtZW50Jykge1xuICAgICAgICB0aGlzLm9wY29kZShbaXNDb21wb25lbnQgPyAnY29tcG9uZW50QXR0cicgOiAnZHluYW1pY0F0dHInLCBbbmFtZSwgbnVsbF1dLCBhY3Rpb24pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoW2lzQ29tcG9uZW50ID8gJ2NvbXBvbmVudEF0dHInIDogJ2R5bmFtaWNBdHRyJywgW25hbWUsIG5hbWVzcGFjZV1dLCBhY3Rpb24pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIG1vZGlmaWVyKFthY3Rpb25dOiBbQVNULkVsZW1lbnRNb2RpZmllclN0YXRlbWVudF0pIHtcbiAgICBhc3NlcnRJc1NpbXBsZVBhdGgoYWN0aW9uLnBhdGgsIGFjdGlvbi5sb2MsICdtb2RpZmllcicpO1xuXG4gICAgbGV0IHtcbiAgICAgIHBhdGg6IHsgcGFydHMgfSxcbiAgICB9ID0gYWN0aW9uO1xuXG4gICAgdGhpcy5wcmVwYXJlSGVscGVyKGFjdGlvbik7XG4gICAgdGhpcy5vcGNvZGUoWydtb2RpZmllcicsIHBhcnRzWzBdXSwgYWN0aW9uKTtcbiAgfVxuXG4gIG11c3RhY2hlKFthY3Rpb25dOiBbQVNULk11c3RhY2hlU3RhdGVtZW50XSkge1xuICAgIGxldCB7IHBhdGggfSA9IGFjdGlvbjtcblxuICAgIGlmIChpc0xpdGVyYWwocGF0aCkpIHtcbiAgICAgIHRoaXMubXVzdGFjaGVFeHByZXNzaW9uKGFjdGlvbik7XG4gICAgICB0aGlzLm9wY29kZShbJ2FwcGVuZCcsICFhY3Rpb24uZXNjYXBlZF0sIGFjdGlvbik7XG4gICAgfSBlbHNlIGlmIChpc1lpZWxkKHBhdGgpKSB7XG4gICAgICBsZXQgdG8gPSBhc3NlcnRWYWxpZFlpZWxkKGFjdGlvbik7XG4gICAgICB0aGlzLnlpZWxkKHRvLCBhY3Rpb24pO1xuICAgIH0gZWxzZSBpZiAoaXNQYXJ0aWFsKHBhdGgpKSB7XG4gICAgICBsZXQgcGFyYW1zID0gYXNzZXJ0VmFsaWRQYXJ0aWFsKGFjdGlvbik7XG4gICAgICB0aGlzLnBhcnRpYWwocGFyYW1zLCBhY3Rpb24pO1xuICAgIH0gZWxzZSBpZiAoaXNEZWJ1Z2dlcihwYXRoKSkge1xuICAgICAgYXNzZXJ0VmFsaWREZWJ1Z2dlclVzYWdlKGFjdGlvbik7XG4gICAgICB0aGlzLmRlYnVnZ2VyKCdkZWJ1Z2dlcicsIGFjdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubXVzdGFjaGVFeHByZXNzaW9uKGFjdGlvbik7XG4gICAgICB0aGlzLm9wY29kZShbJ2FwcGVuZCcsICFhY3Rpb24uZXNjYXBlZF0sIGFjdGlvbik7XG4gICAgfVxuICB9XG5cbiAgYmxvY2soW2FjdGlvbiAvKiwgaW5kZXgsIGNvdW50Ki9dOiBbQVNULkJsb2NrU3RhdGVtZW50XSkge1xuICAgIHRoaXMucHJlcGFyZUhlbHBlcihhY3Rpb24pO1xuICAgIGxldCB0ZW1wbGF0ZUlkID0gdGhpcy50ZW1wbGF0ZUlkcy5wb3AoKSE7XG4gICAgbGV0IGludmVyc2VJZCA9IGFjdGlvbi5pbnZlcnNlID09PSBudWxsID8gbnVsbCA6IHRoaXMudGVtcGxhdGVJZHMucG9wKCkhO1xuICAgIHRoaXMub3Bjb2RlKFsnYmxvY2snLCBbYWN0aW9uLnBhdGgucGFydHNbMF0sIHRlbXBsYXRlSWQsIGludmVyc2VJZF1dLCBhY3Rpb24pO1xuICB9XG5cbiAgLy8vIEludGVybmFsIGFjdGlvbnMsIG5vdCBmb3VuZCBpbiB0aGUgb3JpZ2luYWwgcHJvY2Vzc2VkIGFjdGlvbnNcblxuICBhcmcoW3BhdGhdOiBbQVNULlBhdGhFeHByZXNzaW9uXSkge1xuICAgIGxldCB7XG4gICAgICBwYXJ0czogW2hlYWQsIC4uLnJlc3RdLFxuICAgIH0gPSBwYXRoO1xuICAgIHRoaXMub3Bjb2RlKFsnZ2V0JywgW2BAJHtoZWFkfWAsIHJlc3RdXSwgcGF0aCk7XG4gIH1cblxuICBtdXN0YWNoZUV4cHJlc3Npb24oZXhwcjogQVNULk11c3RhY2hlU3RhdGVtZW50KSB7XG4gICAgbGV0IHsgcGF0aCB9ID0gZXhwcjtcblxuICAgIGlmIChpc0xpdGVyYWwocGF0aCkpIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIHBhdGgudmFsdWVdLCBleHByKTtcbiAgICB9IGVsc2UgaWYgKGlzQnVpbHRJbkhlbHBlcihwYXRoKSkge1xuICAgICAgdGhpcy5idWlsdEluSGVscGVyKGV4cHIgYXMgQVNULkNhbGwpO1xuICAgIH0gZWxzZSBpZiAoaXNBcmcocGF0aCkpIHtcbiAgICAgIHRoaXMuYXJnKFtwYXRoXSk7XG4gICAgfSBlbHNlIGlmIChpc0hlbHBlckludm9jYXRpb24oZXhwcikpIHtcbiAgICAgIHRoaXMucHJlcGFyZUhlbHBlcihleHByKTtcbiAgICAgIHRoaXMub3Bjb2RlKFsnaGVscGVyJywgcGF0aC5wYXJ0c1swXV0sIGV4cHIpO1xuICAgIH0gZWxzZSBpZiAocGF0aC50aGlzKSB7XG4gICAgICB0aGlzLm9wY29kZShbJ2dldCcsIFswLCBwYXRoLnBhcnRzXV0sIGV4cHIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgW2hlYWQsIC4uLnBhcnRzXSA9IHBhdGgucGFydHM7XG4gICAgICB0aGlzLm9wY29kZShbJ21heWJlR2V0JywgW2hlYWQsIHBhcnRzXV0sIGV4cHIpO1xuICAgIH1cblxuICAgIC8vIH0gZWxzZSBpZiAoaXNMb2NhbChwYXRoLCB0aGlzLnN5bWJvbHMpKSB7XG4gICAgLy8gICBsZXQgW2hlYWQsIC4uLnBhcnRzXSA9IHBhdGgucGFydHM7XG4gICAgLy8gICB0aGlzLm9wY29kZShbJ2dldCcsIFtoZWFkLCBwYXJ0c11dLCBleHByKTtcbiAgICAvLyB9IGVsc2UgaWYgKGlzU2ltcGxlUGF0aChwYXRoKSkge1xuICAgIC8vICAgdGhpcy5vcGNvZGUoWyd1bmtub3duJywgcGF0aC5wYXJ0c1swXV0sIGV4cHIpO1xuICAgIC8vIH0gZWxzZSB7XG4gICAgLy8gICB0aGlzLm9wY29kZShbJ21heWJlTG9jYWwnLCBwYXRoLnBhcnRzXSwgZXhwcik7XG4gICAgLy8gfVxuICB9XG5cbiAgLy8vIEludGVybmFsIFN5bnRheFxuXG4gIHlpZWxkKHRvOiBzdHJpbmcsIGFjdGlvbjogQVNULk11c3RhY2hlU3RhdGVtZW50KSB7XG4gICAgdGhpcy5wcmVwYXJlUGFyYW1zKGFjdGlvbi5wYXJhbXMpO1xuICAgIHRoaXMub3Bjb2RlKFsneWllbGQnLCB0b10sIGFjdGlvbik7XG4gIH1cblxuICBkZWJ1Z2dlcihfbmFtZTogc3RyaW5nLCBhY3Rpb246IEFTVC5NdXN0YWNoZVN0YXRlbWVudCkge1xuICAgIHRoaXMub3Bjb2RlKFsnZGVidWdnZXInLCBudWxsXSwgYWN0aW9uKTtcbiAgfVxuXG4gIGhhc0Jsb2NrKG5hbWU6IHN0cmluZywgYWN0aW9uOiBBU1QuQ2FsbCkge1xuICAgIHRoaXMub3Bjb2RlKFsnaGFzQmxvY2snLCBuYW1lXSwgYWN0aW9uKTtcbiAgfVxuXG4gIGhhc0Jsb2NrUGFyYW1zKG5hbWU6IHN0cmluZywgYWN0aW9uOiBBU1QuQ2FsbCkge1xuICAgIHRoaXMub3Bjb2RlKFsnaGFzQmxvY2tQYXJhbXMnLCBuYW1lXSwgYWN0aW9uKTtcbiAgfVxuXG4gIHBhcnRpYWwoX3BhcmFtczogQVNULkV4cHJlc3Npb25bXSwgYWN0aW9uOiBBU1QuTXVzdGFjaGVTdGF0ZW1lbnQpIHtcbiAgICB0aGlzLnByZXBhcmVQYXJhbXMoYWN0aW9uLnBhcmFtcyk7XG4gICAgdGhpcy5vcGNvZGUoWydwYXJ0aWFsJywgbnVsbF0sIGFjdGlvbik7XG4gIH1cblxuICBidWlsdEluSGVscGVyKGV4cHI6IEFTVC5DYWxsKSB7XG4gICAgbGV0IHsgcGF0aCB9ID0gZXhwcjtcbiAgICBpZiAoaXNIYXNCbG9jayhwYXRoKSkge1xuICAgICAgbGV0IG5hbWUgPSBhc3NlcnRWYWxpZEhhc0Jsb2NrVXNhZ2UoZXhwci5wYXRoLm9yaWdpbmFsLCBleHByKTtcbiAgICAgIHRoaXMuaGFzQmxvY2sobmFtZSwgZXhwcik7XG4gICAgfSBlbHNlIGlmIChpc0hhc0Jsb2NrUGFyYW1zKHBhdGgpKSB7XG4gICAgICBsZXQgbmFtZSA9IGFzc2VydFZhbGlkSGFzQmxvY2tVc2FnZShleHByLnBhdGgub3JpZ2luYWwsIGV4cHIpO1xuICAgICAgdGhpcy5oYXNCbG9ja1BhcmFtcyhuYW1lLCBleHByKTtcbiAgICB9XG4gIH1cblxuICAvLy8gRXhwcmVzc2lvbnMsIGludm9rZWQgcmVjdXJzaXZlbHkgZnJvbSBwcmVwYXJlUGFyYW1zIGFuZCBwcmVwYXJlSGFzaFxuXG4gIFN1YkV4cHJlc3Npb24oZXhwcjogQVNULlN1YkV4cHJlc3Npb24pIHtcbiAgICBpZiAoaXNCdWlsdEluSGVscGVyKGV4cHIucGF0aCkpIHtcbiAgICAgIHRoaXMuYnVpbHRJbkhlbHBlcihleHByKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5wcmVwYXJlSGVscGVyKGV4cHIpO1xuICAgICAgdGhpcy5vcGNvZGUoWydoZWxwZXInLCBleHByLnBhdGgucGFydHNbMF1dLCBleHByKTtcbiAgICB9XG4gIH1cblxuICBQYXRoRXhwcmVzc2lvbihleHByOiBBU1QuUGF0aEV4cHJlc3Npb24pIHtcbiAgICBpZiAoZXhwci5kYXRhKSB7XG4gICAgICB0aGlzLmFyZyhbZXhwcl0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgW2hlYWQsIC4uLnJlc3RdID0gZXhwci5wYXJ0cztcblxuICAgICAgaWYgKGV4cHIudGhpcykge1xuICAgICAgICB0aGlzLm9wY29kZShbJ2dldCcsIFswLCBleHByLnBhcnRzXV0sIGV4cHIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoWydnZXQnLCBbaGVhZCwgcmVzdF1dLCBleHByKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBTdHJpbmdMaXRlcmFsKGFjdGlvbjogQVNULlN0cmluZ0xpdGVyYWwpIHtcbiAgICB0aGlzLm9wY29kZShbJ2xpdGVyYWwnLCBhY3Rpb24udmFsdWVdLCBhY3Rpb24pO1xuICB9XG5cbiAgQm9vbGVhbkxpdGVyYWwoYWN0aW9uOiBBU1QuQm9vbGVhbkxpdGVyYWwpIHtcbiAgICB0aGlzLm9wY29kZShbJ2xpdGVyYWwnLCBhY3Rpb24udmFsdWVdLCBhY3Rpb24pO1xuICB9XG5cbiAgTnVtYmVyTGl0ZXJhbChhY3Rpb246IEFTVC5OdW1iZXJMaXRlcmFsKSB7XG4gICAgdGhpcy5vcGNvZGUoWydsaXRlcmFsJywgYWN0aW9uLnZhbHVlXSwgYWN0aW9uKTtcbiAgfVxuXG4gIE51bGxMaXRlcmFsKGFjdGlvbjogQVNULk51bGxMaXRlcmFsKSB7XG4gICAgdGhpcy5vcGNvZGUoWydsaXRlcmFsJywgYWN0aW9uLnZhbHVlXSwgYWN0aW9uKTtcbiAgfVxuXG4gIFVuZGVmaW5lZExpdGVyYWwoYWN0aW9uOiBBU1QuVW5kZWZpbmVkTGl0ZXJhbCkge1xuICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIGFjdGlvbi52YWx1ZV0sIGFjdGlvbik7XG4gIH1cblxuICAvLy8gVXRpbGl0aWVzXG5cbiAgb3Bjb2RlPE8gZXh0ZW5kcyBTeW1ib2xJbk9wPihvcGNvZGU6IE8sIGFjdGlvbjogT3B0aW9uPEFTVC5CYXNlTm9kZT4gPSBudWxsKSB7XG4gICAgLy8gVE9ETzogVGhpcyBkb2Vzbid0IHJlYWxseSB3b3JrXG4gICAgaWYgKHRoaXMuaW5jbHVkZU1ldGEgJiYgYWN0aW9uKSB7XG4gICAgICAob3Bjb2RlIGFzIGFueSkucHVzaCh0aGlzLm1ldGEoYWN0aW9uKSk7XG4gICAgfVxuXG4gICAgdGhpcy5vcGNvZGVzLnB1c2gob3Bjb2RlKTtcbiAgfVxuXG4gIHByZXBhcmVIZWxwZXIoZXhwcjogQVNULkNhbGwpIHtcbiAgICBhc3NlcnRJc1NpbXBsZVBhdGgoZXhwci5wYXRoLCBleHByLmxvYywgJ2hlbHBlcicpO1xuXG4gICAgbGV0IHsgcGFyYW1zLCBoYXNoIH0gPSBleHByO1xuXG4gICAgdGhpcy5wcmVwYXJlSGFzaChoYXNoKTtcbiAgICB0aGlzLnByZXBhcmVQYXJhbXMocGFyYW1zKTtcbiAgfVxuXG4gIHByZXBhcmVQYXJhbXMocGFyYW1zOiBBU1QuRXhwcmVzc2lvbltdKSB7XG4gICAgaWYgKCFwYXJhbXMubGVuZ3RoKSB7XG4gICAgICB0aGlzLm9wY29kZShbJ2xpdGVyYWwnLCBudWxsXSwgbnVsbCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZm9yIChsZXQgaSA9IHBhcmFtcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgbGV0IHBhcmFtID0gcGFyYW1zW2ldO1xuXG4gICAgICBhc3NlcnQodGhpc1twYXJhbS50eXBlXSwgYFVuaW1wbGVtZW50ZWQgJHtwYXJhbS50eXBlfSBvbiBUZW1wbGF0ZUNvbXBpbGVyYCk7XG4gICAgICAodGhpc1twYXJhbS50eXBlXSBhcyBhbnkpKHBhcmFtKTtcbiAgICB9XG5cbiAgICB0aGlzLm9wY29kZShbJ3ByZXBhcmVBcnJheScsIHBhcmFtcy5sZW5ndGhdLCBudWxsKTtcbiAgfVxuXG4gIHByZXBhcmVIYXNoKGhhc2g6IEFTVC5IYXNoKSB7XG4gICAgbGV0IHBhaXJzID0gaGFzaC5wYWlycztcblxuICAgIGlmICghcGFpcnMubGVuZ3RoKSB7XG4gICAgICB0aGlzLm9wY29kZShbJ2xpdGVyYWwnLCBudWxsXSwgbnVsbCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZm9yIChsZXQgaSA9IHBhaXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBsZXQgeyBrZXksIHZhbHVlIH0gPSBwYWlyc1tpXTtcblxuICAgICAgYXNzZXJ0KHRoaXNbdmFsdWUudHlwZV0sIGBVbmltcGxlbWVudGVkICR7dmFsdWUudHlwZX0gb24gVGVtcGxhdGVDb21waWxlcmApO1xuICAgICAgKHRoaXNbdmFsdWUudHlwZV0gYXMgYW55KSh2YWx1ZSk7XG4gICAgICB0aGlzLm9wY29kZShbJ2xpdGVyYWwnLCBrZXldLCBudWxsKTtcbiAgICB9XG5cbiAgICB0aGlzLm9wY29kZShbJ3ByZXBhcmVPYmplY3QnLCBwYWlycy5sZW5ndGhdLCBudWxsKTtcbiAgfVxuXG4gIHByZXBhcmVBdHRyaWJ1dGVWYWx1ZSh2YWx1ZTogQVNULkF0dHJOb2RlWyd2YWx1ZSddKSB7XG4gICAgLy8gcmV0dXJucyB0aGUgc3RhdGljIHZhbHVlIGlmIHRoZSB2YWx1ZSBpcyBzdGF0aWNcblxuICAgIHN3aXRjaCAodmFsdWUudHlwZSkge1xuICAgICAgY2FzZSAnVGV4dE5vZGUnOlxuICAgICAgICB0aGlzLm9wY29kZShbJ2xpdGVyYWwnLCB2YWx1ZS5jaGFyc10sIHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICBjYXNlICdNdXN0YWNoZVN0YXRlbWVudCc6XG4gICAgICAgIHRoaXMuYXR0cmlidXRlTXVzdGFjaGUoW3ZhbHVlXSk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIGNhc2UgJ0NvbmNhdFN0YXRlbWVudCc6XG4gICAgICAgIHRoaXMucHJlcGFyZUNvbmNhdFBhcnRzKHZhbHVlLnBhcnRzKTtcbiAgICAgICAgdGhpcy5vcGNvZGUoWydjb25jYXQnLCBudWxsXSwgdmFsdWUpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcHJlcGFyZUNvbmNhdFBhcnRzKHBhcnRzOiBBU1QuQ29uY2F0U3RhdGVtZW50WydwYXJ0cyddKSB7XG4gICAgZm9yIChsZXQgaSA9IHBhcnRzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBsZXQgcGFydCA9IHBhcnRzW2ldO1xuXG4gICAgICBpZiAocGFydC50eXBlID09PSAnTXVzdGFjaGVTdGF0ZW1lbnQnKSB7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlTXVzdGFjaGUoW3BhcnRdKTtcbiAgICAgIH0gZWxzZSBpZiAocGFydC50eXBlID09PSAnVGV4dE5vZGUnKSB7XG4gICAgICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIHBhcnQuY2hhcnNdLCBudWxsKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLm9wY29kZShbJ3ByZXBhcmVBcnJheScsIHBhcnRzLmxlbmd0aF0sIG51bGwpO1xuICB9XG5cbiAgYXR0cmlidXRlTXVzdGFjaGUoW2FjdGlvbl06IFtBU1QuTXVzdGFjaGVTdGF0ZW1lbnRdKSB7XG4gICAgdGhpcy5tdXN0YWNoZUV4cHJlc3Npb24oYWN0aW9uKTtcbiAgfVxuXG4gIG1ldGEobm9kZTogQVNULkJhc2VOb2RlKSB7XG4gICAgbGV0IGxvYyA9IG5vZGUubG9jO1xuICAgIGlmICghbG9jKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgbGV0IHsgc291cmNlLCBzdGFydCwgZW5kIH0gPSBsb2M7XG4gICAgcmV0dXJuIFsnbG9jJywgW3NvdXJjZSB8fCBudWxsLCBbc3RhcnQubGluZSwgc3RhcnQuY29sdW1uXSwgW2VuZC5saW5lLCBlbmQuY29sdW1uXV1dO1xuICB9XG59XG5cbmZ1bmN0aW9uIGlzSGVscGVySW52b2NhdGlvbihcbiAgbXVzdGFjaGU6IEFTVC5NdXN0YWNoZVN0YXRlbWVudFxuKTogbXVzdGFjaGUgaXMgQVNULk11c3RhY2hlU3RhdGVtZW50ICYgeyBwYXRoOiBBU1QuUGF0aEV4cHJlc3Npb24gfSB7XG4gIHJldHVybiAoXG4gICAgKG11c3RhY2hlLnBhcmFtcyAmJiBtdXN0YWNoZS5wYXJhbXMubGVuZ3RoID4gMCkgfHxcbiAgICAobXVzdGFjaGUuaGFzaCAmJiBtdXN0YWNoZS5oYXNoLnBhaXJzLmxlbmd0aCA+IDApXG4gICk7XG59XG5cbmZ1bmN0aW9uIGlzU2ltcGxlUGF0aCh7IHBhcnRzIH06IEFTVC5QYXRoRXhwcmVzc2lvbik6IGJvb2xlYW4ge1xuICByZXR1cm4gcGFydHMubGVuZ3RoID09PSAxO1xufVxuXG5mdW5jdGlvbiBpc1lpZWxkKHBhdGg6IEFTVC5QYXRoRXhwcmVzc2lvbikge1xuICByZXR1cm4gcGF0aC5vcmlnaW5hbCA9PT0gJ3lpZWxkJztcbn1cblxuZnVuY3Rpb24gaXNQYXJ0aWFsKHBhdGg6IEFTVC5QYXRoRXhwcmVzc2lvbikge1xuICByZXR1cm4gcGF0aC5vcmlnaW5hbCA9PT0gJ3BhcnRpYWwnO1xufVxuXG5mdW5jdGlvbiBpc0RlYnVnZ2VyKHBhdGg6IEFTVC5QYXRoRXhwcmVzc2lvbikge1xuICByZXR1cm4gcGF0aC5vcmlnaW5hbCA9PT0gJ2RlYnVnZ2VyJztcbn1cblxuZnVuY3Rpb24gaXNIYXNCbG9jayhwYXRoOiBBU1QuUGF0aEV4cHJlc3Npb24pIHtcbiAgcmV0dXJuIHBhdGgub3JpZ2luYWwgPT09ICdoYXMtYmxvY2snO1xufVxuXG5mdW5jdGlvbiBpc0hhc0Jsb2NrUGFyYW1zKHBhdGg6IEFTVC5QYXRoRXhwcmVzc2lvbikge1xuICByZXR1cm4gcGF0aC5vcmlnaW5hbCA9PT0gJ2hhcy1ibG9jay1wYXJhbXMnO1xufVxuXG5mdW5jdGlvbiBpc0J1aWx0SW5IZWxwZXIocGF0aDogQVNULlBhdGhFeHByZXNzaW9uKSB7XG4gIHJldHVybiBpc0hhc0Jsb2NrKHBhdGgpIHx8IGlzSGFzQmxvY2tQYXJhbXMocGF0aCk7XG59XG5cbmZ1bmN0aW9uIGlzQXJnKHBhdGg6IEFTVC5QYXRoRXhwcmVzc2lvbik6IGJvb2xlYW4ge1xuICByZXR1cm4gISFwYXRoWydkYXRhJ107XG59XG5cbmZ1bmN0aW9uIGlzRHluYW1pY0NvbXBvbmVudChlbGVtZW50OiBBU1QuRWxlbWVudE5vZGUpOiBib29sZWFuIHtcbiAgbGV0IG9wZW4gPSBlbGVtZW50LnRhZy5jaGFyQXQoMCk7XG5cbiAgbGV0IFttYXliZUxvY2FsXSA9IGVsZW1lbnQudGFnLnNwbGl0KCcuJyk7XG4gIGxldCBpc05hbWVkQXJndW1lbnQgPSBvcGVuID09PSAnQCc7XG4gIGxldCBpc0xvY2FsID0gZWxlbWVudFsnc3ltYm9scyddLmhhcyhtYXliZUxvY2FsKTtcbiAgbGV0IGlzVGhpc1BhdGggPSBlbGVtZW50LnRhZy5pbmRleE9mKCd0aGlzLicpID09PSAwO1xuXG4gIHJldHVybiBpc0xvY2FsIHx8IGlzTmFtZWRBcmd1bWVudCB8fCBpc1RoaXNQYXRoO1xufVxuXG5mdW5jdGlvbiBpc0NvbXBvbmVudChlbGVtZW50OiBBU1QuRWxlbWVudE5vZGUpOiBib29sZWFuIHtcbiAgbGV0IG9wZW4gPSBlbGVtZW50LnRhZy5jaGFyQXQoMCk7XG4gIGxldCBpc1BhdGggPSBlbGVtZW50LnRhZy5pbmRleE9mKCcuJykgPiAtMTtcblxuICBsZXQgaXNVcHBlckNhc2UgPSBvcGVuID09PSBvcGVuLnRvVXBwZXJDYXNlKCkgJiYgb3BlbiAhPT0gb3Blbi50b0xvd2VyQ2FzZSgpO1xuXG4gIHJldHVybiAoaXNVcHBlckNhc2UgJiYgIWlzUGF0aCkgfHwgaXNEeW5hbWljQ29tcG9uZW50KGVsZW1lbnQpO1xufVxuXG5mdW5jdGlvbiBhc3NlcnRJc1NpbXBsZVBhdGgocGF0aDogQVNULlBhdGhFeHByZXNzaW9uLCBsb2M6IEFTVC5Tb3VyY2VMb2NhdGlvbiwgY29udGV4dDogc3RyaW5nKSB7XG4gIGlmICghaXNTaW1wbGVQYXRoKHBhdGgpKSB7XG4gICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKFxuICAgICAgYFxcYCR7cGF0aC5vcmlnaW5hbH1cXGAgaXMgbm90IGEgdmFsaWQgbmFtZSBmb3IgYSAke2NvbnRleHR9IG9uIGxpbmUgJHtsb2Muc3RhcnQubGluZX0uYCxcbiAgICAgIHBhdGgubG9jXG4gICAgKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBhc3NlcnRWYWxpZFlpZWxkKHN0YXRlbWVudDogQVNULk11c3RhY2hlU3RhdGVtZW50KTogc3RyaW5nIHtcbiAgbGV0IHsgcGFpcnMgfSA9IHN0YXRlbWVudC5oYXNoO1xuXG4gIGlmICgocGFpcnMubGVuZ3RoID09PSAxICYmIHBhaXJzWzBdLmtleSAhPT0gJ3RvJykgfHwgcGFpcnMubGVuZ3RoID4gMSkge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihgeWllbGQgb25seSB0YWtlcyBhIHNpbmdsZSBuYW1lZCBhcmd1bWVudDogJ3RvJ2AsIHN0YXRlbWVudC5sb2MpO1xuICB9IGVsc2UgaWYgKHBhaXJzLmxlbmd0aCA9PT0gMSAmJiBwYWlyc1swXS52YWx1ZS50eXBlICE9PSAnU3RyaW5nTGl0ZXJhbCcpIHtcbiAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoYHlvdSBjYW4gb25seSB5aWVsZCB0byBhIGxpdGVyYWwgdmFsdWVgLCBzdGF0ZW1lbnQubG9jKTtcbiAgfSBlbHNlIGlmIChwYWlycy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gJ2RlZmF1bHQnO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiAocGFpcnNbMF0udmFsdWUgYXMgQVNULlN0cmluZ0xpdGVyYWwpLnZhbHVlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGFzc2VydFZhbGlkUGFydGlhbChzdGF0ZW1lbnQ6IEFTVC5NdXN0YWNoZVN0YXRlbWVudCkgLyogOiBleHByICovIHtcbiAgbGV0IHsgcGFyYW1zLCBoYXNoLCBlc2NhcGVkLCBsb2MgfSA9IHN0YXRlbWVudDtcblxuICBpZiAocGFyYW1zICYmIHBhcmFtcy5sZW5ndGggIT09IDEpIHtcbiAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoXG4gICAgICBgUGFydGlhbCBmb3VuZCB3aXRoIG5vIGFyZ3VtZW50cy4gWW91IG11c3Qgc3BlY2lmeSBhIHRlbXBsYXRlIG5hbWUuIChvbiBsaW5lICR7XG4gICAgICAgIGxvYy5zdGFydC5saW5lXG4gICAgICB9KWAsXG4gICAgICBzdGF0ZW1lbnQubG9jXG4gICAgKTtcbiAgfSBlbHNlIGlmIChoYXNoICYmIGhhc2gucGFpcnMubGVuZ3RoID4gMCkge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihcbiAgICAgIGBwYXJ0aWFsIGRvZXMgbm90IHRha2UgYW55IG5hbWVkIGFyZ3VtZW50cyAob24gbGluZSAke2xvYy5zdGFydC5saW5lfSlgLFxuICAgICAgc3RhdGVtZW50LmxvY1xuICAgICk7XG4gIH0gZWxzZSBpZiAoIWVzY2FwZWQpIHtcbiAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoXG4gICAgICBge3t7cGFydGlhbCAuLi59fX0gaXMgbm90IHN1cHBvcnRlZCwgcGxlYXNlIHVzZSB7e3BhcnRpYWwgLi4ufX0gaW5zdGVhZCAob24gbGluZSAke1xuICAgICAgICBsb2Muc3RhcnQubGluZVxuICAgICAgfSlgLFxuICAgICAgc3RhdGVtZW50LmxvY1xuICAgICk7XG4gIH1cblxuICByZXR1cm4gcGFyYW1zO1xufVxuXG5mdW5jdGlvbiBhc3NlcnRWYWxpZEhhc0Jsb2NrVXNhZ2UodHlwZTogc3RyaW5nLCBjYWxsOiBBU1QuQ2FsbCk6IHN0cmluZyB7XG4gIGxldCB7IHBhcmFtcywgaGFzaCwgbG9jIH0gPSBjYWxsO1xuXG4gIGlmIChoYXNoICYmIGhhc2gucGFpcnMubGVuZ3RoID4gMCkge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihgJHt0eXBlfSBkb2VzIG5vdCB0YWtlIGFueSBuYW1lZCBhcmd1bWVudHNgLCBjYWxsLmxvYyk7XG4gIH1cblxuICBpZiAocGFyYW1zLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiAnZGVmYXVsdCc7XG4gIH0gZWxzZSBpZiAocGFyYW1zLmxlbmd0aCA9PT0gMSkge1xuICAgIGxldCBwYXJhbSA9IHBhcmFtc1swXTtcbiAgICBpZiAocGFyYW0udHlwZSA9PT0gJ1N0cmluZ0xpdGVyYWwnKSB7XG4gICAgICByZXR1cm4gcGFyYW0udmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihcbiAgICAgICAgYHlvdSBjYW4gb25seSB5aWVsZCB0byBhIGxpdGVyYWwgdmFsdWUgKG9uIGxpbmUgJHtsb2Muc3RhcnQubGluZX0pYCxcbiAgICAgICAgY2FsbC5sb2NcbiAgICAgICk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihcbiAgICAgIGAke3R5cGV9IG9ubHkgdGFrZXMgYSBzaW5nbGUgcG9zaXRpb25hbCBhcmd1bWVudCAob24gbGluZSAke2xvYy5zdGFydC5saW5lfSlgLFxuICAgICAgY2FsbC5sb2NcbiAgICApO1xuICB9XG59XG5cbmZ1bmN0aW9uIGFzc2VydFZhbGlkRGVidWdnZXJVc2FnZShzdGF0ZW1lbnQ6IEFTVC5NdXN0YWNoZVN0YXRlbWVudCkge1xuICBsZXQgeyBwYXJhbXMsIGhhc2ggfSA9IHN0YXRlbWVudDtcblxuICBpZiAoaGFzaCAmJiBoYXNoLnBhaXJzLmxlbmd0aCA+IDApIHtcbiAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoYGRlYnVnZ2VyIGRvZXMgbm90IHRha2UgYW55IG5hbWVkIGFyZ3VtZW50c2AsIHN0YXRlbWVudC5sb2MpO1xuICB9XG5cbiAgaWYgKHBhcmFtcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gJ2RlZmF1bHQnO1xuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihgZGVidWdnZXIgZG9lcyBub3QgdGFrZSBhbnkgcG9zaXRpb25hbCBhcmd1bWVudHNgLCBzdGF0ZW1lbnQubG9jKTtcbiAgfVxufVxuIl19